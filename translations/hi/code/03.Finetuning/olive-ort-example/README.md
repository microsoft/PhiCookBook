<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "aed7639909ebbd1960507880cff2ae4c",
  "translation_date": "2025-04-04T17:13:13+00:00",
  "source_file": "code\\03.Finetuning\\olive-ort-example\\README.md",
  "language_code": "hi"
}
-->
# Olive рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Phi3 рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░реЗрдВ

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдЖрдк Olive рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ:

1. LoRA рдПрдбреЗрдкреНрдЯрд░ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░рдХреЗ рд╡рд╛рдХреНрдпрд╛рдВрд╢реЛрдВ рдХреЛ Sad, Joy, Fear, Surprise рдореЗрдВ рд╡рд░реНрдЧреАрдХреГрдд рдХрд░реЗрдВред
1. рдПрдбреЗрдкреНрдЯрд░ рд╡реЗрдЯреНрд╕ рдХреЛ рдмреЗрд╕ рдореЙрдбрд▓ рдореЗрдВ рдорд░реНрдЬ рдХрд░реЗрдВред
1. рдореЙрдбрд▓ рдХреЛ `int4` рдореЗрдВ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝ рдФрд░ рдХреНрд╡рд╛рдВрдЯрд╛рдЗрдЬрд╝ рдХрд░реЗрдВред

рд╣рдо рдЖрдкрдХреЛ рдпрд╣ рднреА рджрд┐рдЦрд╛рдПрдВрдЧреЗ рдХрд┐ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд┐рдП рдЧрдП рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ ONNX Runtime (ORT) Generate API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреИрд╕реЗ рдХрд░реЗрдВред

> **тЪая╕П рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЗ рдкрд╛рд╕ рдЙрдкрдпреБрдХреНрдд GPU рдЙрдкрд▓рдмреНрдз рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП - рдЬреИрд╕реЗ A10, V100, A100ред**

## ЁЯТ╛ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ

рдПрдХ рдирдпрд╛ Python рд╡рд░реНрдЪреБрдЕрд▓ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рдмрдирд╛рдПрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `conda` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

рдЗрд╕рдХреЗ рдмрд╛рдж, Olive рдФрд░ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдбрд┐рдкреЗрдВрдбреЗрдВрд╕реАрдЬрд╝ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## ЁЯзк Olive рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Phi3 рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░реЗрдВ
[Olive рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓](../../../../../code/03.Finetuning/olive-ort-example/phrase-classification.json) рдореЗрдВ *рд╡рд░реНрдХрдлрд╝реНрд▓реЛ* рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд *рдкрд╛рд╕* рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

рдЙрдЪреНрдЪ-рд╕реНрддрд░ рдкрд░, рдпрд╣ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░реЗрдЧрд╛:

1. Phi3 рдХреЛ [dataset/data-classification.json](../../../../../code/03.Finetuning/olive-ort-example/dataset/dataset-classification.json) рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░реЗрдВ (150 рд╕реНрдЯреЗрдкреНрд╕ рдХреЗ рд▓рд┐рдП, рдЬрд┐рд╕реЗ рдЖрдк рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред
1. LoRA рдПрдбреЗрдкреНрдЯрд░ рд╡реЗрдЯреНрд╕ рдХреЛ рдмреЗрд╕ рдореЙрдбрд▓ рдореЗрдВ рдорд░реНрдЬ рдХрд░реЗрдВред рдЗрд╕рд╕реЗ рдЖрдкрдХреЛ ONNX рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ рдПрдХ рд╕рд┐рдВрдЧрд▓ рдореЙрдбрд▓ рдЖрд░реНрдЯрд┐рдлреИрдХреНрдЯ рдорд┐рд▓реЗрдЧрд╛ред
1. Model Builder рдореЙрдбрд▓ рдХреЛ ONNX Runtime рдХреЗ рд▓рд┐рдП рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝ рдХрд░реЗрдЧрд╛ *рдФрд░* рдореЙрдбрд▓ рдХреЛ `int4` рдореЗрдВ рдХреНрд╡рд╛рдВрдЯрд╛рдЗрдЬрд╝ рдХрд░реЗрдЧрд╛ред

рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд░рди рдХрд░реЗрдВ:

```bash
olive run --config phrase-classification.json
```

рдЬрдм Olive рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреВрд░реА рдХрд░ рд▓реЗрдЧрд╛, рддреЛ рдЖрдкрдХрд╛ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рд╣реБрдЖ `int4` рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд┐рдпрд╛ рдЧрдпрд╛ Phi3 рдореЙрдбрд▓ рдпрд╣рд╛рдВ рдЙрдкрд▓рдмреНрдз рд╣реЛрдЧрд╛: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`.

## ЁЯзСтАНЁЯТ╗ рдЕрдкрдиреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд┐рдП рдЧрдП Phi3 рдХреЛ рдЗрдВрдЯреАрдЧреНрд░реЗрдЯ рдХрд░реЗрдВ

рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

рдпрд╣ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдХрд╛ рдПрдХ рд╕рд┐рдВрдЧрд▓ рд╡рд░реНрдб рд╡рд░реНрдЧреАрдХрд░рдг рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (Sad/Joy/Fear/Surprise)ред

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬрдмрдХрд┐ рд╣рдо рд╕рдЯреАрдХрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджреЛрдВ рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рдпрд╛ рдЕрд╢реБрджреНрдзрд┐рдпрд╛рдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдореВрд▓ рднрд╛рд╖рд╛ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдкреНрд░рд╛рдорд╛рдгрд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдкреЗрд╢реЗрд╡рд░ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕ рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рд╕реА рднреА рдЧрд▓рддрдлрд╣рдореА рдпрд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП рд╣рдо рдЙрддреНрддрд░рджрд╛рдпреА рдирд╣реАрдВ рд╣реИрдВред