<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "4164123a700fecd535d850f09506d72a",
  "translation_date": "2025-05-09T04:44:21+00:00",
  "source_file": "code/04.Finetuning/olive-ort-example/README.md",
  "language_code": "ne"
}
-->
# Phi3 рд▓рд╛рдИ Olive рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ Fine-tune рдЧрд░реНрдиреЗ

рдпрд╕ рдЙрджрд╛рд╣рд░рдгрдорд╛ рддрдкрд╛рдИрдВ Olive рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░:

1. LoRA adapter рд▓рд╛рдИ fine-tune рдЧрд░реЗрд░ рд╡рд╛рдХреНрдпрд╛рдВрд╢рд╣рд░реВрд▓рд╛рдИ Sad, Joy, Fear, Surprise рдорд╛ рд╡рд░реНрдЧреАрдХрд░рдг рдЧрд░реНрдиреЗред
1. Adapter рдХрд╛ weights рд▓рд╛рдИ base model рдорд╛ merge рдЧрд░реНрдиреЗред
1. Model рд▓рд╛рдИ optimize рд░ quantize рдЧрд░реЗрд░ `int4` рдорд╛ рдкрд░рд┐рдгрдд рдЧрд░реНрдиреЗред

рд╣рд╛рдореАрд▓реЗ fine-tuned model рд▓рд╛рдИ ONNX Runtime (ORT) Generate API рдкреНрд░рдпреЛрдЧ рдЧрд░реА рдХрд╕рд░реА inference рдЧрд░реНрдиреЗ рдкрдирд┐ рджреЗрдЦрд╛рдЙрдиреЗрдЫреМрдВред

> **тЪая╕П Fine-tuning рдЧрд░реНрдирдХрд╛ рд▓рд╛рдЧрд┐ рдЙрдкрдпреБрдХреНрдд GPU рдЖрд╡рд╢реНрдпрдХ рдЫ - рдЬрд╕реНрддреИ, A10, V100, A100ред**

## ЁЯТ╛ Install

рдирдпрд╛рдБ Python virtual environment рдмрдирд╛рдЙрдиреБрд╣реЛрд╕реН (рдЙрджрд╛рд╣рд░рдгрдХрд╛ рд▓рд╛рдЧрд┐ `conda` рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

рдкрдЫрд┐, Olive рд░ fine-tuning workflow рдХрд╛ рд▓рд╛рдЧрд┐ рдЖрд╡рд╢реНрдпрдХ dependencies install рдЧрд░реНрдиреБрд╣реЛрд╕реН:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## ЁЯзк Olive рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ Phi3 рд▓рд╛рдИ Fine-tune рдЧрд░реНрдиреЗ
[Olive configuration file](../../../../../code/04.Finetuning/olive-ort-example/phrase-classification.json) рдорд╛ рдирд┐рдореНрди *workflow* рд░ *passes* рдЫрдиреН:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

рд╕рд╛рд░рд╛рдВрд╢рдорд╛, рдпреЛ workflow рд▓реЗ:

1. Phi3 рд▓рд╛рдИ fine-tune рдЧрд░реНрдиреЗ (150 steps рдХрд╛ рд▓рд╛рдЧрд┐, рддрдкрд╛рдИрдВрд▓реЗ рдкрд░рд┐рд╡рд░реНрддрди рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ) [dataset/data-classification.json](../../../../../code/04.Finetuning/olive-ort-example/dataset/dataset-classification.json) рдбрд╛рдЯрд╛рдХреЛ рдкреНрд░рдпреЛрдЧ рдЧрд░реАред
1. LoRA adapter weights рд▓рд╛рдИ base model рдорд╛ merge рдЧрд░реНрдиреЗред рдпрд╕рд▓реЗ ONNX format рдорд╛ рдПрдХрд▓ model artifact рджрд┐рдиреЗрдЫред
1. Model Builder рд▓реЗ model рд▓рд╛рдИ ONNX runtime рдХрд╛ рд▓рд╛рдЧрд┐ optimize рдЧрд░реНрдиреЗ *рд░* model рд▓рд╛рдИ `int4` рдорд╛ quantize рдЧрд░реНрдиреЗрдЫред

Workflow рдЪрд▓рд╛рдЙрдирдХрд╛ рд▓рд╛рдЧрд┐:

```bash
olive run --config phrase-classification.json
```

Olive рд╕рдХрд┐рдПрдкрдЫрд┐, рддрдкрд╛рдИрдВрдХреЛ optimized `int4` fine-tuned Phi3 model рдпреЛ рдареЗрдЧрд╛рдирд╛рдорд╛ рдЙрдкрд▓рдмреНрдз рд╣реБрдиреЗрдЫ: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`ред

## ЁЯзСтАНЁЯТ╗ Fine-tuned Phi3 рд▓рд╛рдИ рддрдкрд╛рдИрдВрдХреЛ application рдорд╛ integrate рдЧрд░реНрдиреЗ

App рдЪрд▓рд╛рдЙрдирдХрд╛ рд▓рд╛рдЧрд┐:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

рдпрд╕рд▓реЗ рд╡рд╛рдХреНрдпрд╛рдВрд╢рдХреЛ рдПрдХ рд╢рдмреНрдж classification рджрд┐рдиреЗрдЫ (Sad/Joy/Fear/Surprise)ред

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рдпреЛ рджрд╕реНрддрд╛рд╡реЗрдЬ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЕрдиреБрд╡рд╛рдж рдЧрд░рд┐рдПрдХреЛ рд╣реЛред рд╣рд╛рдореА рд╕рдЯреАрдХрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдЧрд░реНрди рдкреНрд░рдпрд╛рд╕рд░рдд рдЫреМрдВ, рддрд░ рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджрд┐рдиреБрд╣реЛрд╕реН рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджрдорд╛ рддреНрд░реБрдЯрд┐ рд╡рд╛ рдЕрд╢реБрджреНрдзрддрд╛ рд╣реБрди рд╕рдХреНрдЫред рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬ рдпрд╕рдХреЛ рдореВрд▓ рднрд╛рд╖рд╛рдорд╛ рдЕрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд┐рдиреБрдкрд░реНрдЫред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реАрдХрд╛ рд▓рд╛рдЧрд┐ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рд╕рд┐рдлрд╛рд░рд┐рд╕ рдЧрд░рд┐рдиреНрдЫред рдпрд╕ рдЕрдиреБрд╡рд╛рджрдХреЛ рдкреНрд░рдпреЛрдЧрдмрд╛рдЯ рдЙрддреНрдкрдиреНрди рдХреБрдиреИ рдкрдирд┐ рдЧрд▓рддрдлрд╣рдореА рд╡рд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛рдорд╛ рд╣рд╛рдореА рдЬрд┐рдореНрдореЗрд╡рд╛рд░ рдЫреИрдиреМрдВред