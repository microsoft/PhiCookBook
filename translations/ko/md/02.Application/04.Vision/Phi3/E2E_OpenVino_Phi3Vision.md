이 데모는 사전 학습된 모델을 사용하여 이미지와 텍스트 프롬프트를 기반으로 Python 코드를 생성하는 방법을 보여줍니다.

[Sample Code](../../../../../../code/06.E2E/E2E_OpenVino_Phi3-vision.ipynb)

단계별 설명은 다음과 같습니다:

1. **임포트 및 설정**:
   - `requests`, 이미지 처리를 위한 `PIL`, 모델과 처리를 위한 `transformers` 등 필요한 라이브러리와 모듈을 임포트합니다.

2. **이미지 불러오기 및 표시**:
   - `PIL` 라이브러리를 사용해 이미지 파일(`demo.png`)을 열고 화면에 표시합니다.

3. **프롬프트 정의**:
   - 이미지와 함께 이미지를 처리하고 `plt`(matplotlib)를 사용해 저장하는 Python 코드를 생성해 달라는 요청을 포함한 메시지를 만듭니다.

4. **프로세서 로드**:
   - `out_dir` 디렉터리에 지정된 사전 학습된 모델에서 `AutoProcessor`를 불러옵니다. 이 프로세서는 텍스트와 이미지 입력을 처리합니다.

5. **프롬프트 생성**:
   - `apply_chat_template` 메서드를 사용해 메시지를 모델에 적합한 프롬프트 형식으로 만듭니다.

6. **입력 처리**:
   - 프롬프트와 이미지를 모델이 이해할 수 있는 텐서로 변환합니다.

7. **생성 인자 설정**:
   - 최대 생성 토큰 수, 샘플링 여부 등 모델의 생성 과정에 필요한 인자를 정의합니다.

8. **코드 생성**:
   - 입력과 생성 인자를 바탕으로 모델이 Python 코드를 생성합니다. `TextStreamer`를 사용해 프롬프트와 특수 토큰을 건너뛰며 출력을 처리합니다.

9. **출력**:
   - 생성된 코드를 출력합니다. 이 코드는 프롬프트에 명시된 대로 이미지를 처리하고 저장하는 Python 코드가 포함되어야 합니다.

이 데모는 OpenVino를 활용해 사전 학습된 모델로 사용자 입력과 이미지를 기반으로 동적으로 코드를 생성하는 방법을 보여줍니다.

**면책 조항**:  
이 문서는 AI 번역 서비스 [Co-op Translator](https://github.com/Azure/co-op-translator)를 사용하여 번역되었습니다. 정확성을 위해 최선을 다하고 있으나, 자동 번역에는 오류나 부정확한 부분이 있을 수 있음을 유의해 주시기 바랍니다. 원문은 해당 언어의 원본 문서가 권위 있는 자료로 간주되어야 합니다. 중요한 정보의 경우 전문적인 인간 번역을 권장합니다. 본 번역의 사용으로 인해 발생하는 오해나 잘못된 해석에 대해 당사는 책임을 지지 않습니다.