<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "4164123a700fecd535d850f09506d72a",
  "translation_date": "2025-05-09T04:31:03+00:00",
  "source_file": "code/03.Finetuning/olive-ort-example/README.md",
  "language_code": "bn"
}
-->
# Olive ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ Phi3 ржлрж╛ржЗржи-ржЯрж┐ржЙржи ржХрж░рж╛

ржПржЗ ржЙржжрж╛рж╣рж░ржгрзЗ ржЖржкржирж┐ Olive ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ:

1. LoRA ржЕрзНржпрж╛ржбрж╛ржкрзНржЯрж╛рж░ ржлрж╛ржЗржи-ржЯрж┐ржЙржи ржХрж░ржмрзЗржи ржпрж╛рждрзЗ ржлрзНрж░рзЗржЬржЧрзБрж▓рзЛржХрзЗ Sad, Joy, Fear, Surprise рж╣рж┐рж╕рзЗржмрзЗ рж╢рзНрж░рзЗржгрзАржмржжрзНржз ржХрж░рж╛ ржпрж╛ржпрж╝ред
1. ржЕрзНржпрж╛ржбрж╛ржкрзНржЯрж╛рж░рзЗрж░ ржУржЬржиржЧрзБрж▓рзЛржХрзЗ ржмрзЗрж╕ ржоржбрзЗрж▓рзЗрж░ рж╕рж╛ржерзЗ ржорж╛рж░рзНржЬ ржХрж░ржмрзЗржиред
1. ржоржбрзЗрж▓ржЯрж┐ржХрзЗ `int4` ржП ржЕржкржЯрж┐ржорж╛ржЗржЬ ржПржмржВ ржХрзЛржпрж╝рж╛ржирзНржЯрж╛ржЗржЬ ржХрж░ржмрзЗржиред

ржЖржорж░рж╛ ржжрзЗржЦрж╛ржмрзЛ ржХрж┐ржнрж╛ржмрзЗ ONNX Runtime (ORT) Generate API ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржлрж╛ржЗржи-ржЯрж┐ржЙржи ржХрж░рж╛ ржоржбрзЗрж▓ ржерзЗржХрзЗ ржЗржиржлрж╛рж░рзЗржирзНрж╕ ржирж┐рждрзЗ рж╣ржпрж╝ред

> **тЪая╕П ржлрж╛ржЗржи-ржЯрж┐ржЙржи ржХрж░рж╛рж░ ржЬржирзНржп, ржЖржкржирж╛рж░ ржХрж╛ржЫрзЗ ржПржХржЯрж┐ ржЙржкржпрзБржХрзНржд GPU ржерж╛ржХрж╛ ржжрж░ржХрж╛рж░ - ржпрзЗржоржи A10, V100, A100ред**

## ЁЯТ╛ ржЗржирж╕рзНржЯрж▓рзЗрж╢ржи

ржирждрзБржи ржПржХржЯрж┐ Python ржнрж╛рж░рзНржЪрзБржпрж╝рж╛рж▓ ржПржиржнрж╛ржпрж╝рж░ржиржорзЗржирзНржЯ рждрзИрж░рж┐ ржХрж░рзБржи (ржпрзЗржоржи, `conda` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

ржПрж░ржкрж░, Olive ржПржмржВ ржлрж╛ржЗржи-ржЯрж┐ржЙржирж┐ржВ ржУржпрж╝рж╛рж░рзНржХржлрзНрж▓рзЛрж░ ржЬржирзНржп ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржбрж┐ржкрзЗржирзНржбрзЗржирзНрж╕рж┐ржЧрзБрж▓рзЛ ржЗржирж╕рзНржЯрж▓ ржХрж░рзБржи:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## ЁЯзк Olive ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ Phi3 ржлрж╛ржЗржи-ржЯрж┐ржЙржи ржХрж░рж╛
[Olive ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи ржлрж╛ржЗрж▓](../../../../../code/03.Finetuning/olive-ort-example/phrase-classification.json) ржПржХржЯрж┐ *ржУржпрж╝рж╛рж░рзНржХржлрзНрж▓рзЛ* ржзрж╛рж░ржг ржХрж░рзЗ ржпрж╛рж░ ржоржзрзНржпрзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд *ржкрж╛рж╕* рж░ржпрж╝рзЗржЫрзЗ:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

ржЙржЪрзНржЪ ржкрж░рзНржпрж╛ржпрж╝рзЗ, ржПржЗ ржУржпрж╝рж╛рж░рзНржХржлрзНрж▓рзЛржЯрж┐ ржХрж░ржмрзЗ:

1. Phi3 ржХрзЗ (рззрзлрзж рж╕рзНржЯрзЗржк ржкрж░рзНржпржирзНржд, ржпрж╛ ржЖржкржирж┐ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржи) ржлрж╛ржЗржи-ржЯрж┐ржЙржи ржХрж░рж╛ рж╣ржмрзЗ [dataset/data-classification.json](../../../../../code/03.Finetuning/olive-ort-example/dataset/dataset-classification.json) ржбрзЗржЯрж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред
1. LoRA ржЕрзНржпрж╛ржбрж╛ржкрзНржЯрж╛рж░рзЗрж░ ржУржЬржиржЧрзБрж▓рзЛ ржмрзЗрж╕ ржоржбрзЗрж▓рзЗрж░ рж╕рж╛ржерзЗ ржорж╛рж░рзНржЬ ржХрж░рж╛ рж╣ржмрзЗред ржПрж░ ржлрж▓рзЗ ржЖржкржирж┐ ONNX ржлрж░ржорзНржпрж╛ржЯрзЗ ржПржХржЯрж┐ ржПржХржХ ржоржбрзЗрж▓ ржЖрж░рзНржЯрж┐ржлрзНржпрж╛ржХрзНржЯ ржкрж╛ржмрзЗржиред
1. Model Builder ржоржбрзЗрж▓ржЯрж┐ржХрзЗ ONNX рж░рж╛ржиржЯрж╛ржЗржорзЗрж░ ржЬржирзНржп ржЕржкржЯрж┐ржорж╛ржЗржЬ ржПржмржВ `int4` ржП ржХрзЛржпрж╝рж╛ржирзНржЯрж╛ржЗржЬ ржХрж░ржмрзЗред

ржУржпрж╝рж╛рж░рзНржХржлрзНрж▓рзЛ ржЪрж╛рж▓рж╛ржирзЛрж░ ржЬржирзНржп, рж░рж╛ржи ржХрж░рзБржи:

```bash
olive run --config phrase-classification.json
```

ржпржЦржи Olive рж╢рзЗрж╖ ржХрж░ржмрзЗ, ржЖржкржирж╛рж░ ржЕржкржЯрж┐ржорж╛ржЗржЬ ржХрж░рж╛ `int4` ржлрж╛ржЗржи-ржЯрж┐ржЙржи ржХрж░рж╛ Phi3 ржоржбрзЗрж▓ржЯрж┐ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржмрзЗ: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`ред

## ЁЯзСтАНЁЯТ╗ ржлрж╛ржЗржи-ржЯрж┐ржЙржи ржХрж░рж╛ Phi3 ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржирзЗ ржЗржирзНржЯрж┐ржЧрзНрж░рзЗржЯ ржХрж░рзБржи

ржЕрзНржпрж╛ржк ржЪрж╛рж▓рж╛ржирзЛрж░ ржЬржирзНржп:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

ржПржЗ рж░рзЗрж╕ржкржирзНрж╕ рж╣ржмрзЗ ржлрзНрж░рзЗржЬрзЗрж░ ржПржХржХ рж╢ржмрзНржжрзЗрж░ рж╢рзНрж░рзЗржгрзАржмрж┐ржнрж╛ржЧ (Sad/Joy/Fear/Surprise)ред

**ржЕрж╕рзНржмрзАржХрж╛рж░рзЛржХрзНрждрж┐**:  
ржПржЗ ржиржерж┐ржЯрж┐ AI ржЕржирзБржмрж╛ржж рж╕рзЗржмрж╛ [Co-op Translator](https://github.com/Azure/co-op-translator) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЕржирзВржжрж┐ржд рж╣ржпрж╝рзЗржЫрзЗред ржЖржорж░рж╛ ржпржерж╛рж╕рж╛ржзрзНржп рж╕ржарж┐ржХрждрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рж┐, рждржмрзЗ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ ржЕржирзБржмрж╛ржжрзЗ рждрзНрж░рзБржЯрж┐ ржмрж╛ ржЕрж╕ржЩрзНржЧрждрж┐ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ ржмрж▓рзЗ ржжржпрж╝рж╛ ржХрж░рзЗ рж╕ржЪрзЗрждржи ржерж╛ржХрзБржиред ржорзВрж▓ ржиржерж┐ржЯрж┐ рждрж╛рж░ ржирж┐ржЬрж╕рзНржм ржнрж╛рж╖рж╛ржпрж╝ржЗ ржХрж░рзНрждрзГржкржХрзНрж╖ржнрзБржХрзНржд ржЙрзОрж╕ рж╣рж┐рж╕рзЗржмрзЗ ржмрж┐ржмрзЗржЪрж┐ржд рж╣ржУржпрж╝рж╛ ржЙржЪрж┐рждред ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг рждржерзНржпрзЗрж░ ржЬржирзНржп ржкрзЗрж╢рж╛ржжрж╛рж░ ржорж╛ржиржм ржЕржирзБржмрж╛ржжрзЗрж░ ржкрж░рж╛ржорж░рзНрж╢ ржжрзЗржУржпрж╝рж╛ рж╣ржпрж╝ред ржПржЗ ржЕржирзБржмрж╛ржжрзЗрж░ ржмрзНржпржмрж╣рж╛рж░ ржерзЗржХрзЗ ржЙржжрзНржнрзВржд ржХрзЛржирзЛ ржнрзБрж▓ ржмрзЛржЭрж╛ржмрзБржЭрж┐ ржмрж╛ ржнрзБрж▓ ржмрзНржпрж╛ржЦрзНржпрж╛рж░ ржЬржирзНржп ржЖржорж░рж╛ ржжрж╛ржпрж╝рзА ржиржЗред