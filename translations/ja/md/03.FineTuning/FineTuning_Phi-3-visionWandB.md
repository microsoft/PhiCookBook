<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "74689a2b87f747d751edfec988ccb7fd",
  "translation_date": "2025-04-04T13:26:58+00:00",
  "source_file": "md\\03.FineTuning\\FineTuning_Phi-3-visionWandB.md",
  "language_code": "ja"
}
-->
# Phi-3-Vision-128K-Instruct プロジェクト概要

## モデル

Phi-3-Vision-128K-Instructは、軽量で最先端のマルチモーダルモデルであり、このプロジェクトの中核を担っています。このモデルはPhi-3モデルファミリーの一部で、最大128,000トークンのコンテキスト長をサポートします。合成データや厳選された公開ウェブサイトを含む多様なデータセットを使用して学習されており、高品質で推論に重点を置いたコンテンツが特徴です。学習プロセスには、監督型の微調整と直接的な嗜好最適化が含まれており、指示への正確な従順性と堅牢な安全対策が確保されています。

## サンプルデータを作成することが重要な理由

1. **テスト**: サンプルデータを使用することで、実際のデータに影響を与えることなく、さまざまなシナリオでアプリケーションをテストできます。これは特に開発段階やステージング段階で重要です。

2. **パフォーマンス調整**: 実際のデータの規模や複雑さを模倣したサンプルデータを使用することで、性能のボトルネックを特定し、アプリケーションを最適化できます。

3. **プロトタイピング**: サンプルデータはプロトタイプやモックアップの作成に使用でき、ユーザーの要件を理解したりフィードバックを得たりするのに役立ちます。

4. **データ分析**: データサイエンスでは、サンプルデータは探索的データ分析、モデル学習、アルゴリズムテストに頻繁に使用されます。

5. **セキュリティ**: 開発やテスト環境でサンプルデータを使用することで、実際の機密データの漏洩を防ぐことができます。

6. **学習**: 新しい技術やツールを学ぶ際に、サンプルデータを使用することで実践的な経験を得ることができます。

サンプルデータの品質はこれらの活動に大きな影響を与える可能性があります。構造や変動性において、実際のデータにできるだけ近いものを使用することが重要です。

### サンプルデータ作成
[データセット生成スクリプト](./CreatingSampleData.md)

## データセット

サンプルデータセットの良い例としては、[DBQ/Burberry.Product.prices.United.States dataset](https://huggingface.co/datasets/DBQ/Burberry.Product.prices.United.States) (Huggingfaceで利用可能)があります。  
Burberry製品のサンプルデータセットには、製品カテゴリー、価格、タイトルに関するメタデータが含まれ、合計3,040行で構成されており、各行がユニークな製品を表しています。このデータセットを使用すると、モデルが視覚データを理解し解釈する能力をテストでき、複雑な視覚的詳細やブランド特有の特徴を捉える記述文を生成する能力を評価できます。

**注意:** 画像を含む任意のデータセットを使用することができます。

## 複雑な推論

モデルは画像のみを基に価格や名前を推論する必要があります。これは、モデルが視覚的特徴を認識するだけでなく、それらの製品価値やブランドの観点での意味を理解する必要があることを意味します。画像から正確なテキスト記述を生成することで、視覚データを統合してモデルの性能と汎用性を向上させる可能性を実証します。

## Phi-3 Vision アーキテクチャ

このモデルのアーキテクチャはPhi-3のマルチモーダルバージョンです。テキストと画像データの両方を処理し、これらの入力を統一されたシーケンスに統合して包括的な理解と生成タスクを実現します。モデルはテキストと画像の埋め込み層を個別に使用します。テキストトークンは密なベクトルに変換され、画像はCLIPビジョンモデルを通じて特徴埋め込みを抽出します。これらの画像埋め込みはテキスト埋め込みの次元に合わせて投影され、シームレスに統合できるようにします。

## テキストと画像埋め込みの統合

テキストシーケンス内の特別なトークンは画像埋め込みを挿入する場所を示します。処理中にこれらの特別なトークンは対応する画像埋め込みに置き換えられ、モデルがテキストと画像を単一のシーケンスとして扱えるようにします。データセットのプロンプトは、特別な<|image|>トークンを使用して以下の形式でフォーマットされます。

```python
text = f"<|user|>\n<|image_1|>What is shown in this image?<|end|><|assistant|>\nProduct: {row['title']}, Category: {row['category3_code']}, Full Price: {row['full_price']}<|end|>"
```

## サンプルコード
- [Phi-3-Vision トレーニングスクリプト](../../../../code/03.Finetuning/Phi-3-vision-Trainingscript.py)
- [Weights and Bias 使用例の解説](https://wandb.ai/byyoung3/mlnews3/reports/How-to-fine-tune-Phi-3-vision-on-a-custom-dataset--Vmlldzo4MTEzMTg3)

**免責事項**:  
この文書は、AI翻訳サービス [Co-op Translator](https://github.com/Azure/co-op-translator) を使用して翻訳されています。正確性を追求しておりますが、自動翻訳には誤りや不正確な部分が含まれる可能性があります。元の言語で作成された文書を信頼できる情報源としてご参照ください。重要な情報については、専門の人間による翻訳を推奨いたします。この翻訳の使用に起因する誤解や誤解釈について、当社は一切の責任を負いません。