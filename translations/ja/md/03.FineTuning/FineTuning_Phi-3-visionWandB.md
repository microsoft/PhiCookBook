<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "e0a07fd2a30fe2af30b1373df207a5bf",
  "translation_date": "2025-05-08T05:16:10+00:00",
  "source_file": "md/03.FineTuning/FineTuning_Phi-3-visionWandB.md",
  "language_code": "ja"
}
-->
# Phi-3-Vision-128K-Instruct プロジェクト概要

## モデルについて

Phi-3-Vision-128K-Instruct は軽量で最先端のマルチモーダルモデルで、本プロジェクトの中核を担っています。Phi-3 モデルファミリーの一部であり、最大128,000トークンのコンテキスト長に対応しています。合成データや厳選された公開ウェブサイトを含む多様なデータセットでトレーニングされており、高品質で推論力の高いコンテンツを重視しています。トレーニングには教師ありファインチューニングと直接的な嗜好最適化が含まれ、指示への正確な対応と強固な安全対策が施されています。

## サンプルデータ作成が重要な理由

1. **テスト**: サンプルデータは、実データに影響を与えずに様々なシナリオでアプリケーションをテストすることを可能にします。特に開発やステージング段階で重要です。

2. **パフォーマンスチューニング**: 実データの規模や複雑さを模したサンプルデータを使うことで、パフォーマンスのボトルネックを特定し、最適化が行えます。

3. **プロトタイピング**: サンプルデータはプロトタイプやモックアップの作成に活用でき、ユーザーの要件理解やフィードバック取得に役立ちます。

4. **データ分析**: データサイエンスでは、探索的データ分析やモデルのトレーニング、アルゴリズムのテストにサンプルデータがよく用いられます。

5. **セキュリティ**: 開発・テスト環境でサンプルデータを使用することで、実際の機密データの漏洩リスクを防げます。

6. **学習**: 新しい技術やツールを学ぶ際に、サンプルデータを使うことで実践的に習得内容を応用できます。

サンプルデータの品質はこれらの活動に大きな影響を与えます。構造や変動性が実データにできるだけ近いことが望ましいです。

### サンプルデータ作成
[Generate DataSet Script](./CreatingSampleData.md)

## データセット

良いサンプルデータセットの例として、[DBQ/Burberry.Product.prices.United.States dataset](https://huggingface.co/datasets/DBQ/Burberry.Product.prices.United.States)（Huggingfaceで利用可能）があります。  
Burberry製品のサンプルデータセットで、製品カテゴリ、価格、タイトルのメタデータを含む合計3,040行があり、それぞれがユニークな製品を表しています。このデータセットは、モデルが視覚データを理解し解釈する能力をテストし、詳細な視覚的特徴やブランド固有の特性を捉えた記述テキストを生成することを可能にします。

**Note:** 画像を含む任意のデータセットを使用できます。

## 複雑な推論

モデルは画像のみから価格や名称について推論する必要があります。これは、視覚的特徴を認識するだけでなく、それが製品価値やブランドにどのように関連するかを理解することを要求します。画像から正確なテキスト記述を合成することで、本プロジェクトは視覚データを統合し、実世界の応用におけるモデルの性能と多様性を高める可能性を示しています。

## Phi-3 Vision アーキテクチャ

モデルアーキテクチャは Phi-3 のマルチモーダル版です。テキストと画像の両方のデータを処理し、これらの入力を統合したシーケンスとして扱うことで、包括的な理解と生成タスクを実現しています。テキストと画像にはそれぞれ別々の埋め込み層を使用します。テキストトークンは密ベクトルに変換され、画像はCLIPビジョンモデルを通じて特徴埋め込みを抽出します。これらの画像埋め込みはテキスト埋め込みの次元に射影され、シームレスに統合できるように調整されます。

## テキストと画像埋め込みの統合

テキストシーケンス内の特殊トークンが画像埋め込みを挿入すべき位置を示します。処理中にこれらの特殊トークンは対応する画像埋め込みに置き換えられ、モデルはテキストと画像を一つのシーケンスとして扱います。データセットのプロンプトは特殊な <|image|> トークンを使って以下のようにフォーマットされています：

```python
text = f"<|user|>\n<|image_1|>What is shown in this image?<|end|><|assistant|>\nProduct: {row['title']}, Category: {row['category3_code']}, Full Price: {row['full_price']}<|end|>"
```

## サンプルコード
- [Phi-3-Vision Training Script](../../../../code/03.Finetuning/Phi-3-vision-Trainingscript.py)
- [Weights and Bias Example walkthrough](https://wandb.ai/byyoung3/mlnews3/reports/How-to-fine-tune-Phi-3-vision-on-a-custom-dataset--Vmlldzo4MTEzMTg3)

**免責事項**：  
本書類はAI翻訳サービス「Co-op Translator」（https://github.com/Azure/co-op-translator）を使用して翻訳されました。正確性には努めておりますが、自動翻訳には誤りや不正確な部分が含まれる可能性があります。原文の言語によるオリジナル文書が正式な情報源として扱われるべきです。重要な情報については、専門の人間による翻訳を推奨します。本翻訳の利用により生じた誤解や誤訳について、一切の責任を負いかねます。