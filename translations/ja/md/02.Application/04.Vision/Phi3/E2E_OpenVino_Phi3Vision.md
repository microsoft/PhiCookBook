このデモでは、画像とテキストプロンプトに基づいてPythonコードを生成するために、事前学習済みモデルを使用する方法を紹介します。

[Sample Code](../../../../../../code/06.E2E/E2E_OpenVino_Phi3-vision.ipynb)

ステップごとの説明は以下の通りです：

1. **インポートとセットアップ**:
   - `requests`、画像処理用の`PIL`、モデルと処理を扱うための`transformers`など、必要なライブラリとモジュールをインポートします。

2. **画像の読み込みと表示**:
   - `PIL`ライブラリを使って画像ファイル（`demo.png`）を開き、表示します。

3. **プロンプトの定義**:
   - 画像を含むメッセージを作成し、画像を処理して`plt`（matplotlib）を使って保存するPythonコードの生成を依頼します。

4. **プロセッサの読み込み**:
   - `out_dir`ディレクトリで指定された事前学習済みモデルから`AutoProcessor`を読み込みます。このプロセッサがテキストと画像の入力を処理します。

5. **プロンプトの作成**:
   - `apply_chat_template`メソッドを使って、メッセージをモデルに適したプロンプト形式に整えます。

6. **入力の処理**:
   - プロンプトと画像をモデルが理解できるテンソルに変換します。

7. **生成パラメータの設定**:
   - 最大生成トークン数やサンプリングの有無など、モデルの生成処理に関する引数を定義します。

8. **コードの生成**:
   - 入力と生成パラメータに基づいてモデルがPythonコードを生成します。`TextStreamer`を使って、プロンプトや特殊トークンをスキップしながら出力を処理します。

9. **出力**:
   - 生成されたコードを表示します。プロンプトで指定した通り、画像を処理して保存するPythonコードが含まれているはずです。

このデモは、OpenVinoを活用して事前学習済みモデルからユーザー入力と画像に基づくコードを動的に生成する方法を示しています。

**免責事項**：  
本書類はAI翻訳サービス「[Co-op Translator](https://github.com/Azure/co-op-translator)」を使用して翻訳されました。正確性を期しておりますが、自動翻訳には誤りや不正確な部分が含まれる可能性があります。原文の言語による文書が正式な情報源とみなされるべきです。重要な情報については、専門の人間による翻訳を推奨します。本翻訳の利用により生じた誤解や誤訳について、当方は一切の責任を負いかねます。