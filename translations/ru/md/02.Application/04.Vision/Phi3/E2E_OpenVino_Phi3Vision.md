Это демонстрация того, как использовать предобученную модель для генерации Python-кода на основе изображения и текстового запроса.

[Sample Code](../../../../../../code/06.E2E/E2E_OpenVino_Phi3-vision.ipynb)

Пошаговое объяснение:

1. **Импорты и настройка**:
   - Импортируются необходимые библиотеки и модули, включая `requests`, `PIL` для обработки изображений и `transformers` для работы с моделью и обработкой данных.

2. **Загрузка и отображение изображения**:
   - Открывается файл изображения (`demo.png`) с помощью библиотеки `PIL` и отображается.

3. **Определение запроса**:
   - Создаётся сообщение, включающее изображение и просьбу сгенерировать Python-код для обработки изображения и сохранения результата с помощью `plt` (matplotlib).

4. **Загрузка процессора**:
   - Загружается `AutoProcessor` из предобученной модели, расположенной в директории `out_dir`. Этот процессор будет обрабатывать текстовые и визуальные входные данные.

5. **Создание запроса**:
   - Метод `apply_chat_template` используется для форматирования сообщения в запрос, подходящий для модели.

6. **Обработка входных данных**:
   - Запрос и изображение преобразуются в тензоры, которые модель сможет обработать.

7. **Настройка параметров генерации**:
   - Определяются параметры генерации модели, включая максимальное количество новых токенов и выбор режима сэмплирования вывода.

8. **Генерация кода**:
   - Модель генерирует Python-код на основе входных данных и параметров генерации. Для обработки вывода используется `TextStreamer`, который пропускает запрос и специальные токены.

9. **Вывод**:
   - Печатается сгенерированный код, который должен содержать Python-код для обработки изображения и сохранения результата, как указано в запросе.

Этот пример демонстрирует, как использовать предобученную модель с OpenVino для динамической генерации кода на основе пользовательского ввода и изображений.

**Отказ от ответственности**:  
Этот документ был переведен с помощью сервиса автоматического перевода [Co-op Translator](https://github.com/Azure/co-op-translator). Несмотря на наши усилия по обеспечению точности, просим учитывать, что автоматический перевод может содержать ошибки или неточности. Оригинальный документ на его исходном языке следует считать авторитетным источником. Для получения критически важной информации рекомендуется обращаться к профессиональному переводу, выполненному человеком. Мы не несем ответственности за любые недоразумения или неправильные толкования, возникшие в результате использования данного перевода.