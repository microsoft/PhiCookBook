# –¢–æ–Ω–∫–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Phi3 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Olive

–£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î—Ç–µ Olive, —â–æ–±:

1. –¢–æ–Ω–∫–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ LoRA –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ñ—Ä–∞–∑ –Ω–∞ Sad, Joy, Fear, Surprise.
1. –û–±‚Äô—î–¥–Ω–∞—Ç–∏ –≤–∞–≥–∏ –∞–¥–∞–ø—Ç–µ—Ä–∞ –∑ –±–∞–∑–æ–≤–æ—é –º–æ–¥–µ–ª–ª—é.
1. –û–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ —Ç–∞ –∫–≤–∞–Ω—Ç—É–≤–∞—Ç–∏ –º–æ–¥–µ–ª—å —É `int4`.

–¢–∞–∫–æ–∂ –º–∏ –ø–æ–∫–∞–∂–µ–º–æ, —è–∫ —Ä–æ–±–∏—Ç–∏ —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å —Ç–æ–Ω–∫–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ—ó –º–æ–¥–µ–ª—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ONNX Runtime (ORT) Generate API.

> **‚ö†Ô∏è –î–ª—è —Ç–æ–Ω–∫–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–µ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π GPU ‚Äî –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, A10, V100, A100.**

## üíæ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

–°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–µ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ Python (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `conda`):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

–î–∞–ª—ñ –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å Olive —Ç–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—É —Ç–æ–Ω–∫–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## üß™ –¢–æ–Ω–∫–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Phi3 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Olive
[–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª Olive](../../../../../code/04.Finetuning/olive-ort-example/phrase-classification.json) –º—ñ—Å—Ç–∏—Ç—å *workflow* –∑ —Ç–∞–∫–∏–º–∏ *–µ—Ç–∞–ø–∞–º–∏*:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

–ù–∞ –≤–∏—Å–æ–∫–æ–º—É —Ä—ñ–≤–Ω—ñ —Ü–µ–π workflow –≤–∏–∫–æ–Ω–∞—î:

1. –¢–æ–Ω–∫–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Phi3 (150 –∫—Ä–æ–∫—ñ–≤, —è–∫—ñ –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏) –Ω–∞ –¥–∞–Ω–∏—Ö –∑ [dataset/data-classification.json](../../../../../code/04.Finetuning/olive-ort-example/dataset/dataset-classification.json).
1. –û–±‚Äô—î–¥–Ω–∞–Ω–Ω—è –≤–∞–≥ LoRA –∞–¥–∞–ø—Ç–µ—Ä–∞ –∑ –±–∞–∑–æ–≤–æ—é –º–æ–¥–µ–ª–ª—é. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –æ—Ç—Ä–∏–º–∞—î—Ç–µ —î–¥–∏–Ω–∏–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –º–æ–¥–µ–ª—ñ —É —Ñ–æ—Ä–º–∞—Ç—ñ ONNX.
1. Model Builder –æ–ø—Ç–∏–º—ñ–∑—É—î –º–æ–¥–µ–ª—å –¥–ª—è ONNX runtime *—Ç–∞* –∫–≤–∞–Ω—Ç—É—î —ó—ó —É `int4`.

–©–æ–± –∑–∞–ø—É—Å—Ç–∏—Ç–∏ workflow, –≤–∏–∫–æ–Ω–∞–π—Ç–µ:

```bash
olive run --config phrase-classification.json
```

–ü—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è Olive, –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∞ `int4` —Ç–æ–Ω–∫–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –º–æ–¥–µ–ª—å Phi3 –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –∑–∞ –∞–¥—Ä–µ—Å–æ—é: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`.

## üßë‚Äçüíª –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è —Ç–æ–Ω–∫–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ—ó Phi3 —É –≤–∞—à –¥–æ–¥–∞—Ç–æ–∫

–©–æ–± –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

–í—ñ–¥–ø–æ–≤—ñ–¥—å –º–∞—î –±—É—Ç–∏ –æ–¥–Ω–æ—Å–ª–æ–≤–Ω–æ—é –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é —Ñ—Ä–∞–∑–∏ (Sad/Joy/Fear/Surprise).

**–í—ñ–¥–º–æ–≤–∞ –≤—ñ–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ**:  
–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –±—É–ª–æ –ø–µ—Ä–µ–∫–ª–∞–¥–µ–Ω–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–µ—Ä–≤—ñ—Å—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª–∞–¥—É [Co-op Translator](https://github.com/Azure/co-op-translator). –•–æ—á–∞ –º–∏ –ø—Ä–∞–≥–Ω–µ–º–æ –¥–æ —Ç–æ—á–Ω–æ—Å—Ç—ñ, –±—É–¥—å –ª–∞—Å–∫–∞, –º–∞–π—Ç–µ –Ω–∞ —É–≤–∞–∑—ñ, —â–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ø–µ—Ä–µ–∫–ª–∞–¥–∏ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ –∞–±–æ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç—ñ. –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –¥–æ–∫—É–º–µ–Ω—Ç —Ä—ñ–¥–Ω–æ—é –º–æ–≤–æ—é —Å–ª—ñ–¥ –≤–≤–∞–∂–∞—Ç–∏ –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω–∏–º –¥–∂–µ—Ä–µ–ª–æ–º. –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –¥–æ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–æ–≥–æ –ª—é–¥—Å—å–∫–æ–≥–æ –ø–µ—Ä–µ–∫–ª–∞–¥—É. –ú–∏ –Ω–µ –Ω–µ—Å–µ–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –∑–∞ –±—É–¥—å-—è–∫—ñ –Ω–µ–ø–æ—Ä–æ–∑—É–º—ñ–Ω–Ω—è –∞–±–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ —Ç–ª—É–º–∞—á–µ–Ω–Ω—è, —â–æ –≤–∏–Ω–∏–∫–ª–∏ –≤–Ω–∞—Å–ª—ñ–¥–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—å–æ–≥–æ –ø–µ—Ä–µ–∫–ª–∞–¥—É.