[OpenVino Chat Sample](../../../../../../code/06.E2E/E2E_OpenVino_Chat_Phi3-instruct.ipynb)

இந்த குறியீடு ஒரு மாதிரியை OpenVINO வடிவத்திற்கு ஏற்றுமதி செய்து, அதை ஏற்றுமதி செய்து, கொடுக்கப்பட்ட உந்துதலுக்கு பதிலளிக்க பயன்படுத்துகிறது.

1. **மாதிரியை ஏற்றுமதி செய்தல்**:
   ```bash
   optimum-cli export openvino --model "microsoft/Phi-3-mini-4k-instruct" --task text-generation-with-past --weight-format int4 --group-size 128 --ratio 0.6 --sym --trust-remote-code ./model/phi3-instruct/int4
   ```
   - இந்த கட்டளை `optimum-cli` கருவியை பயன்படுத்தி ஒரு மாதிரியை OpenVINO வடிவத்திற்கு ஏற்றுமதி செய்கிறது, இது திறமையான முடிவுகளை பெறுவதற்காக மேம்படுத்தப்பட்டுள்ளது.
   - ஏற்றுமதி செய்யப்படும் மாதிரி `"microsoft/Phi-3-mini-4k-instruct"` ஆகும், இது முந்தைய சூழலின் அடிப்படையில் உரை உருவாக்கும் பணிக்காக அமைக்கப்பட்டுள்ளது.
   - மாதிரியின் எடைகள் 4-பிட் முழு எண்களாக (`int4`) அளவிடப்பட்டுள்ளன, இது மாதிரியின் அளவை குறைக்கவும் செயலாக்கத்தை வேகமாக்கவும் உதவுகிறது.
   - `group-size`, `ratio`, மற்றும் `sym` போன்ற பிற அளவீடுகள் அளவீட்டு செயல்முறையை நன்றாக அமைக்க பயன்படுத்தப்படுகின்றன.
   - ஏற்றுமதி செய்யப்பட்ட மாதிரி `./model/phi3-instruct/int4` என்ற அடைவில் சேமிக்கப்படுகிறது.

2. **தேவையான நூலகங்களை இறக்குமதி செய்தல்**:
   ```python
   from transformers import AutoConfig, AutoTokenizer
   from optimum.intel.openvino import OVModelForCausalLM
   ```
   - இந்த வரிகள் `transformers` நூலகத்திலிருந்து மற்றும் `optimum.intel.openvino` தொகுதியிலிருந்து வகுப்புகளை இறக்குமதி செய்கின்றன, இது மாதிரியை ஏற்றவும் பயன்படுத்தவும் தேவையானவை.

3. **மாதிரி அடைவு மற்றும் கட்டமைப்பை அமைத்தல்**:
   ```python
   model_dir = './model/phi3-instruct/int4'
   ov_config = {
       "PERFORMANCE_HINT": "LATENCY",
       "NUM_STREAMS": "1",
       "CACHE_DIR": ""
   }
   ```
   - `model_dir` மாதிரி கோப்புகள் எங்கு சேமிக்கப்பட்டுள்ளன என்பதை குறிப்பிடுகிறது.
   - `ov_config` என்பது OpenVINO மாதிரியை குறைந்த தாமதத்தை முன்னுரிமை அளிக்க, ஒரு முடிவு ஓட்டத்தை பயன்படுத்த, மற்றும் கேஷ் அடைவை பயன்படுத்தாமல் அமைக்க ஒரு அகராதி ஆகும்.

4. **மாதிரியை ஏற்றுதல்**:
   ```python
   ov_model = OVModelForCausalLM.from_pretrained(
       model_dir,
       device='GPU.0',
       ov_config=ov_config,
       config=AutoConfig.from_pretrained(model_dir, trust_remote_code=True),
       trust_remote_code=True,
   )
   ```
   - இந்த வரி முன்பே வரையறுக்கப்பட்ட கட்டமைப்பு அமைப்புகளைப் பயன்படுத்தி குறிப்பிட்ட அடைவிலிருந்து மாதிரியை ஏற்றுகிறது. தேவையானால் தொலைநிலை குறியீடு செயல்படுத்தலையும் அனுமதிக்கிறது.

5. **டோக்கனைசரை ஏற்றுதல்**:
   ```python
   tok = AutoTokenizer.from_pretrained(model_dir, trust_remote_code=True)
   ```
   - இந்த வரி டோக்கனைசரை ஏற்றுகிறது, இது உரையை மாதிரி புரிந்துகொள்ளக்கூடிய டோக்கன்களாக மாற்றுவதற்குப் பொறுப்பாக உள்ளது.

6. **டோக்கனைசர் அளவீடுகளை அமைத்தல்**:
   ```python
   tokenizer_kwargs = {
       "add_special_tokens": False
   }
   ```
   - இந்த அகராதி டோக்கனைசர் வெளியீட்டில் சிறப்பு டோக்கன்கள் சேர்க்கப்படக்கூடாது என்பதை குறிப்பிடுகிறது.

7. **உந்துதலை வரையறுத்தல்**:
   ```python
   prompt = "<|system|>You are a helpful AI assistant.<|end|><|user|>can you introduce yourself?<|end|><|assistant|>"
   ```
   - இந்த சரம் ஒரு உரையாடல் உந்துதலை அமைக்கிறது, இதில் பயனர் AI உதவியாளரை தன்னை அறிமுகப்படுத்துமாறு கேட்கிறார்.

8. **உந்துதலை டோக்கனைச செய்தல்**:
   ```python
   input_tokens = tok(prompt, return_tensors="pt", **tokenizer_kwargs)
   ```
   - இந்த வரி உந்துதலை மாதிரி செயலாக்கக்கூடிய டோக்கன்களாக மாற்றுகிறது, முடிவை PyTorch டென்சர்களாக திருப்புகிறது.

9. **பதிலை உருவாக்குதல்**:
   ```python
   answer = ov_model.generate(**input_tokens, max_new_tokens=1024)
   ```
   - இந்த வரி மாதிரியை பயன்படுத்தி உள்ளீட்டு டோக்கன்களின் அடிப்படையில் பதிலை உருவாக்குகிறது, அதிகபட்சம் 1024 புதிய டோக்கன்களுடன்.

10. **பதிலை டிகோடிங் செய்தல்**:
    ```python
    decoded_answer = tok.batch_decode(answer, skip_special_tokens=True)[0]
    ```
    - இந்த வரி உருவாக்கப்பட்ட டோக்கன்களை மீண்டும் மனிதர்களுக்குப் புரிந்துகொள்ளக்கூடிய சரமாக மாற்றுகிறது, சிறப்பு டோக்கன்களை தவிர்த்து, முதல் முடிவை பெறுகிறது.

---

**குறிப்பு**:  
இந்த ஆவணம் AI மொழிபெயர்ப்பு சேவை [Co-op Translator](https://github.com/Azure/co-op-translator) பயன்படுத்தி மொழிபெயர்க்கப்பட்டுள்ளது. நாங்கள் துல்லியத்திற்காக முயற்சிக்கின்றோம், ஆனால் தானியங்கி மொழிபெயர்ப்புகளில் பிழைகள் அல்லது தவறான தகவல்கள் இருக்கக்கூடும் என்பதை கவனத்தில் கொள்ளவும். அதன் தாய்மொழியில் உள்ள மூல ஆவணம் அதிகாரப்பூர்வ ஆதாரமாக கருதப்பட வேண்டும். முக்கியமான தகவல்களுக்கு, தொழில்முறை மனித மொழிபெயர்ப்பு பரிந்துரைக்கப்படுகிறது. இந்த மொழிபெயர்ப்பைப் பயன்படுத்துவதால் ஏற்படும் எந்த தவறான புரிதல்கள் அல்லது தவறான விளக்கங்களுக்கு நாங்கள் பொறுப்பல்ல.