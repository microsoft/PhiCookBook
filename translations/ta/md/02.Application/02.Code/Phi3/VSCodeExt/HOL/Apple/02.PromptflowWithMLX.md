# **லாப் 2 - AIPC-இல் Phi-3-mini உடன் Prompt flow இயக்குதல்**

## **Prompt flow என்றால் என்ன**

Prompt flow என்பது LLM அடிப்படையிலான AI பயன்பாடுகளின் முழுமையான மேம்பாட்டு சுழற்சியை (கருத்து உருவாக்கம், மாதிரி உருவாக்கம், சோதனை, மதிப்பீடு, உற்பத்தி பயன்பாடு மற்றும் கண்காணிப்பு) எளிமைப்படுத்த வடிவமைக்கப்பட்ட மேம்பாட்டு கருவிகளின் தொகுப்பாகும். இது prompt engineering-ஐ மிகவும் எளிதாக்குகிறது மற்றும் உற்பத்தி தரத்துடன் LLM பயன்பாடுகளை உருவாக்க உதவுகிறது.

Prompt flow மூலம், நீங்கள் செய்யக்கூடியவை:

- LLMகள், prompts, Python குறியீடு மற்றும் பிற கருவிகளை இணைக்கும் flows-ஐ உருவாக்கி செயல்படுத்தக்கூடிய workflow உருவாக்குதல்.

- உங்கள் flows-ஐ, குறிப்பாக LLMகளுடன் உள்ள தொடர்புகளை எளிதாக debug மற்றும் iterate செய்யுதல்.

- உங்கள் flows-ஐ மதிப்பீடு செய்து, பெரிய தரவுத்தொகுப்புகளுடன் தரம் மற்றும் செயல்திறன் அளவுகோள்களை கணக்கிடுதல்.

- உங்கள் CI/CD அமைப்பில் சோதனை மற்றும் மதிப்பீட்டை ஒருங்கிணைத்து flow-இன் தரத்தை உறுதிப்படுத்துதல்.

- உங்கள் flows-ஐ நீங்கள் தேர்ந்தெடுத்த சேவை தளத்தில் அல்லது உங்கள் பயன்பாட்டின் குறியீட்டு அடிப்படையில் எளிதாக ஒருங்கிணைத்து பயன்பாட்டில் கொண்டு வருதல்.

- (விருப்பமானது ஆனால் மிகவும் பரிந்துரைக்கப்படுகிறது) Azure AI-இல் Prompt flow-இன் cloud பதிப்பைப் பயன்படுத்தி உங்கள் குழுவுடன் இணைந்து பணியாற்றுதல்.



## **Apple Silicon-இல் generation code flows உருவாக்குதல்**

***குறிப்பு*** ：நீங்கள் சூழல் நிறுவலை முடிக்கவில்லை என்றால், [லாப் 0 - நிறுவல்கள்](./01.Installations.md) பார்க்கவும்.

1. Visual Studio Code-இல் Prompt flow Extension-ஐ திறந்து ஒரு காலியான flow project உருவாக்கவும்.

![create](../../../../../../../../../imgs/02/vscodeext/pf_create.png)

2. Inputs மற்றும் Outputs அளவுருக்களை சேர்த்து, Python Code-ஐ புதிய flow ஆக சேர்க்கவும்.

![flow](../../../../../../../../../imgs/02/vscodeext/pf_flow.png)

இந்த அமைப்பை (flow.dag.yaml) பயன்படுத்தி உங்கள் flow-ஐ அமைக்கலாம்.

```yaml

inputs:
  prompt:
    type: string
    default: Write python code for Fibonacci serie. Please use markdown as output
outputs:
  result:
    type: string
    reference: ${gen_code_by_phi3.output}
nodes:
- name: gen_code_by_phi3
  type: python
  source:
    type: code
    path: gen_code_by_phi3.py
  inputs:
    prompt: ${inputs.prompt}


```

3. phi-3-mini-ஐ அளவிடுதல்

SLM-ஐ உள்ளூர் சாதனங்களில் சிறப்பாக இயக்க விரும்புகிறோம். பொதுவாக, மாடலை (INT4, FP16, FP32) அளவிடுகிறோம்.

```bash

python -m mlx_lm.convert --hf-path microsoft/Phi-3-mini-4k-instruct

```

**குறிப்பு:** இயல்புநிலை கோப்புறை mlx_model ஆகும்.

4. ***Chat_With_Phi3.py***-இல் குறியீட்டை சேர்க்கவும்.

```python


from promptflow import tool

from mlx_lm import load, generate


# The inputs section will change based on the arguments of the tool function, after you save the code
# Adding type to arguments and return value will help the system show the types properly
# Please update the function name/signature per need
@tool
def my_python_tool(prompt: str) -> str:

    model_id = './mlx_model_phi3_mini'

    model, tokenizer = load(model_id)

    # <|user|>\nWrite python code for Fibonacci serie. Please use markdown as output<|end|>\n<|assistant|>

    response = generate(model, tokenizer, prompt="<|user|>\n" + prompt  + "<|end|>\n<|assistant|>", max_tokens=2048, verbose=True)

    return response


```

4. Debug அல்லது Run மூலம் flow-ஐ சோதித்து generation code சரியாக இருக்கிறதா என்பதை சரிபார்க்கலாம்.

![RUN](../../../../../../../../../imgs/02/vscodeext/pf_run.png)

5. Terminal-இல் development API ஆக flow-ஐ இயக்கவும்.

```

pf flow serve --source ./ --port 8080 --host localhost   

```

Postman / Thunder Client-இல் இதை சோதிக்கலாம்.


### **குறிப்பு**

1. முதல் இயக்கம் அதிக நேரம் எடுக்கும். Hugging face CLI-இல் இருந்து phi-3 மாடலை பதிவிறக்க பரிந்துரைக்கப்படுகிறது.

2. Intel NPU-வின் வரையறுக்கப்பட்ட கணினி சக்தியை கருத்தில் கொண்டு, Phi-3-mini-4k-instruct-ஐ பயன்படுத்த பரிந்துரைக்கப்படுகிறது.

3. INT4 மாற்றத்தை அளவிட Intel NPU Acceleration-ஐ பயன்படுத்துகிறோம், ஆனால் நீங்கள் சேவையை மீண்டும் இயக்கினால், cache மற்றும் nc_workshop கோப்புறைகளை நீக்க வேண்டும்.



## **வளங்கள்**

1. Promptflow கற்றுக்கொள்ள [https://microsoft.github.io/promptflow/](https://microsoft.github.io/promptflow/)

2. Intel NPU Acceleration கற்றுக்கொள்ள [https://github.com/intel/intel-npu-acceleration-library](https://github.com/intel/intel-npu-acceleration-library)

3. மாதிரி குறியீடு, பதிவிறக்க [உள்ளூர் NPU Agent மாதிரி குறியீடு](../../../../../../../../../code/07.Lab/01/AIPC/local-npu-agent)

---

**குறிப்பு**:  
இந்த ஆவணம் [Co-op Translator](https://github.com/Azure/co-op-translator) என்ற AI மொழிபெயர்ப்பு சேவையைப் பயன்படுத்தி மொழிபெயர்க்கப்பட்டுள்ளது. நாங்கள் துல்லியத்திற்காக முயற்சிக்கின்றோம், ஆனால் தானியங்கி மொழிபெயர்ப்புகளில் பிழைகள் அல்லது தவறான தகவல்கள் இருக்கக்கூடும் என்பதை தயவுசெய்து கவனத்தில் கொள்ளுங்கள். அதன் தாய்மொழியில் உள்ள மூல ஆவணம் அதிகாரப்பூர்வ ஆதாரமாக கருதப்பட வேண்டும். முக்கியமான தகவல்களுக்கு, தொழில்முறை மனித மொழிபெயர்ப்பு பரிந்துரைக்கப்படுகிறது. இந்த மொழிபெயர்ப்பைப் பயன்படுத்துவதால் ஏற்படும் எந்த தவறான புரிதல்கள் அல்லது தவறான விளக்கங்களுக்கு நாங்கள் பொறுப்பல்ல.