<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "4164123a700fecd535d850f09506d72a",
  "translation_date": "2025-10-11T11:38:53+00:00",
  "source_file": "code/04.Finetuning/olive-ort-example/README.md",
  "language_code": "ta"
}
-->
# Olive-роР рокропройрпНрокроЯрпБродрпНродро┐ Phi3-роР Fine-tune роЪрпЖропрпНропро╡рпБроорпН

роЗроирпНрод роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯро┐ро▓рпН, Olive-роР рокропройрпНрокроЯрпБродрпНродро┐ роирпАроЩрпНроХро│рпН роЪрпЖропрпНропрокрпНрокрпЛроХро┐ро▒рпАро░рпНроХро│рпН:

1. LoRA adapter-роР fine-tune роЪрпЖропрпНродрпБ Sad, Joy, Fear, Surprise роЖроХро┐роп рокро┐ро░ро┐ро╡рпБроХро│ро╛роХ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпИ ро╡роХрпИрокрпНрокроЯрпБродрпНродро╡рпБроорпН.
2. Adapter роОроЯрпИроХро│рпИроХрпН роЕроЯро┐рокрпНрокроЯрпИ рооро╛родро┐ро░ро┐ропро┐ро▓рпН роЗрогрпИроХрпНроХро╡рпБроорпН.
3. рооро╛родро┐ро░ро┐ропрпИ `int4` роЖроХ Optimize рооро▒рпНро▒рпБроорпН Quantize роЪрпЖропрпНропро╡рпБроорпН.

роорпЗро▓рпБроорпН, ONNX Runtime (ORT) Generate API-ропрпИ рокропройрпНрокроЯрпБродрпНродро┐ fine-tuned рооро╛родро┐ро░ро┐ропрпИ роОро╡рпНро╡ро╛ро▒рпБ inference роЪрпЖропрпНропро▓ро╛роорпН роОройрпНрокродрпИропрпБроорпН роХро╛рогрпНрокро┐роХрпНроХро┐ро▒рпЛроорпН.

> **тЪая╕П Fine-tuning роЪрпЖропрпНроп, роЙроЩрпНроХро│рпБроХрпНроХрпБ роПро▒рпНро▒ GPU родрпЗро╡рпИрокрпНрокроЯрпБроорпН - роЙродро╛ро░рогрооро╛роХ, A10, V100, A100.**

## ЁЯТ╛ роиро┐ро▒рпБро╡ро▓рпН

рокрпБродро┐роп Python virtual environment роТройрпНро▒рпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН (роЙродро╛ро░рогрооро╛роХ, `conda` рокропройрпНрокроЯрпБродрпНродро┐):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

роЕроЯрпБродрпНродродро╛роХ, Olive рооро▒рпНро▒рпБроорпН fine-tuning ро╡рпЗро▓рпИрокрпНрокро╛роЯрпНроЯро┐ро▒рпНроХро╛рой dependencies-роР роиро┐ро▒рпБро╡ро╡рпБроорпН:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## ЁЯзк Olive-роР рокропройрпНрокроЯрпБродрпНродро┐ Phi3-роР Fine-tune роЪрпЖропрпНропро╡рпБроорпН
[Olive configuration file](../../../../../code/04.Finetuning/olive-ort-example/phrase-classification.json) *workflow* роЙроЯройрпН рокро┐ройрпНро╡ро░рпБроорпН *passes* роЙро│рпНро│роЯроХрпНроХро┐ропрпБро│рпНро│родрпБ:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

роорпЗро▓рпНроиро┐ро▓рпИропродрпНродро┐ро▓рпН, роЗроирпНрод workflow роЪрпЖропрпНропрпБроорпН роЪрпЖропро▓рпНроХро│рпН:

1. [dataset/data-classification.json](../../../../../code/04.Finetuning/olive-ort-example/dataset/dataset-classification.json) родро░ро╡рпБроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ Phi3-роР (150 рокроЯро┐роХро│рпН ро╡ро░рпИ, роирпАроЩрпНроХро│рпН роЗродрпИ рооро╛ро▒рпНро▒ро▓ро╛роорпН) fine-tune роЪрпЖропрпНропрпБроорпН.
2. LoRA adapter роОроЯрпИроХро│рпИ роЕроЯро┐рокрпНрокроЯрпИ рооро╛родро┐ро░ро┐ропро┐ро▓рпН роЗрогрпИроХрпНроХрпБроорпН. роЗродройрпН роорпВро▓роорпН ONNX ро╡роЯро┐ро╡родрпНродро┐ро▓рпН роТро░рпБ рооро╛родро┐ро░ро┐ роХро▓рпИрокрпНрокрпКро░рпБро│рпН роХро┐роЯрпИроХрпНроХрпБроорпН.
3. Model Builder рооро╛родро┐ро░ро┐ропрпИ ONNX runtime-роХрпНроХрпБ Optimize роЪрпЖропрпНропрпБроорпН *рооро▒рпНро▒рпБроорпН* рооро╛родро┐ро░ро┐ропрпИ `int4` роЖроХ Quantize роЪрпЖропрпНропрпБроорпН.

роЗроирпНрод workflow-роР роЗропроХрпНроХ, роХрпАро┤рпЗ роЙро│рпНро│родрпИ роЗропроХрпНроХро╡рпБроорпН:

```bash
olive run --config phrase-classification.json
```

Olive роорпБроЯро┐роирпНродро╡рпБроЯройрпН, роирпАроЩрпНроХро│рпН Optimize роЪрпЖропрпНропрокрпНрокроЯрпНроЯ `int4` fine-tuned Phi3 рооро╛родро┐ро░ро┐ропрпИ роЗроЩрпНроХрпЗ рокрпЖро▒ро▓ро╛роорпН: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`.

## ЁЯзСтАНЁЯТ╗ Fine-tuned Phi3-роР роЙроЩрпНроХро│рпН рокропройрпНрокро╛роЯрпНроЯро┐ро▓рпН роТро░рпБроЩрпНроХро┐рогрпИроХрпНроХро╡рпБроорпН 

рокропройрпНрокро╛роЯрпНроЯрпИ роЗропроХрпНроХ:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

роЗроирпНрод рокродро┐ро▓рпН ро╡ро╛роХрпНроХро┐ропродрпНродро┐ройрпН ро╡роХрпИрокрпНрокро╛роЯрпНроЯрпИ (Sad/Joy/Fear/Surprise) роТро░рпБ роЪрпКро▓рпН ро╡роЯро┐ро╡ро┐ро▓рпН ро╡ро┤роЩрпНроХрпБроорпН.

---

**роЕро▒ро┐ро╡ро┐рокрпНрокрпБ**:  
роЗроирпНрод роЖро╡рогроорпН [Co-op Translator](https://github.com/Azure/co-op-translator) роОройрпНро▒ AI роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ роЪрпЗро╡рпИропрпИ рокропройрпНрокроЯрпБродрпНродро┐ роорпКро┤ро┐рокрпЖропро░рпНроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ. роиро╛роЩрпНроХро│рпН родрпБро▓рпНро▓ро┐ропродрпНродро┐ро▒рпНроХро╛роХ роорпБропро▒рпНроЪро┐роХрпНроХро┐ро▒рпЛроорпН, роЖройро╛ро▓рпН родро╛ройро┐ропроЩрпНроХро┐ роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБроХро│ро┐ро▓рпН рокро┐ро┤рпИроХро│рпН роЕро▓рпНро▓родрпБ родро╡ро▒рпБроХро│рпН роЗро░рпБроХрпНроХроХрпНроХрпВроЯрпБроорпН роОройрпНрокродрпИ роХро╡ройродрпНродро┐ро▓рпН роХрпКро│рпНро│ро╡рпБроорпН. роЕродройрпН роЪрпКроирпНрод роорпКро┤ро┐ропро┐ро▓рпН роЙро│рпНро│ роорпВро▓ роЖро╡рогроорпН роЕродро┐роХро╛ро░рокрпНрокрпВро░рпНро╡ роЖродро╛ро░рооро╛роХ роХро░рпБродрокрпНрокроЯ ро╡рпЗрогрпНроЯрпБроорпН. роорпБроХрпНроХро┐ропрооро╛рой родроХро╡ро▓рпНроХро│рпБроХрпНроХрпБ, родрпКро┤ро┐ро▓рпНроорпБро▒рпИ рооройро┐род роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ рокро░ро┐роирпНродрпБро░рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ. роЗроирпНрод роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родро╛ро▓рпН роПро▒рпНрокроЯрпБроорпН роОроирпНрод родро╡ро▒ро╛рой рокрпБро░ро┐родро▓рпНроХро│рпБроХрпНроХрпБроорпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой ро╡ро┐ро│роХрпНроХроЩрпНроХро│рпБроХрпНроХрпБроорпН роиро╛роЩрпНроХро│рпН рокрпКро▒рпБрокрпНрокро▓рпНро▓.