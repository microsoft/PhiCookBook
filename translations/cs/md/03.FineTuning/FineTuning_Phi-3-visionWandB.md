<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "e0a07fd2a30fe2af30b1373df207a5bf",
  "translation_date": "2025-05-09T21:50:04+00:00",
  "source_file": "md/03.FineTuning/FineTuning_Phi-3-visionWandB.md",
  "language_code": "cs"
}
-->
# Phi-3-Vision-128K-Instruct Проект Обзор

## Модель

Phi-3-Vision-128K-Instruct — это легкая, передовая мультимодальная модель, которая лежит в основе этого проекта. Она входит в семейство моделей Phi-3 и поддерживает длину контекста до 128 000 токенов. Модель была обучена на разнообразном наборе данных, включающем синтетические данные и тщательно отфильтрованные общедоступные веб-сайты, с упором на высококачественный контент, требующий глубокого анализа. Процесс обучения включал контролируемую донастройку и оптимизацию предпочтений для точного следования инструкциям, а также надежные меры безопасности.

## Создание примерных данных важно по нескольким причинам:

1. **Тестирование**: Примерные данные позволяют тестировать приложение в различных сценариях, не затрагивая реальные данные. Это особенно важно на этапах разработки и тестирования.

2. **Оптимизация производительности**: Используя примерные данные, которые имитируют масштаб и сложность реальных данных, можно выявлять узкие места в производительности и оптимизировать приложение.

3. **Прототипирование**: Примерные данные помогают создавать прототипы и макеты, что способствует лучшему пониманию требований пользователей и получению обратной связи.

4. **Анализ данных**: В науке о данных примерные данные часто используются для разведочного анализа, обучения моделей и тестирования алгоритмов.

5. **Безопасность**: Использование примерных данных в средах разработки и тестирования помогает предотвратить случайные утечки чувствительной информации.

6. **Обучение**: Если вы осваиваете новую технологию или инструмент, работа с примерными данными дает практическое применение полученным знаниям.

Помните, качество примерных данных существенно влияет на эффективность этих задач. Они должны максимально соответствовать структуре и вариативности реальных данных.

### Создание примерных данных
[Generate DataSet Script](./CreatingSampleData.md)

## Набор данных

Хорошим примером примерного набора данных является [DBQ/Burberry.Product.prices.United.States dataset](https://huggingface.co/datasets/DBQ/Burberry.Product.prices.United.States) (доступен на Huggingface).  
Этот набор содержит данные о продуктах Burberry вместе с метаданными о категории продукта, цене и названии, всего 3040 строк, каждая из которых представляет уникальный продукт. Этот набор позволяет проверить способность модели понимать и интерпретировать визуальные данные, генерируя описательный текст, который отражает сложные визуальные детали и особенности бренда.

**Note:** Вы можете использовать любой набор данных, который включает изображения.

## Сложное рассуждение

Модель должна делать выводы о ценах и названиях, имея только изображение. Это требует не только распознавания визуальных признаков, но и понимания их значения с точки зрения ценности продукта и брендинга. Создавая точные текстовые описания на основе изображений, проект демонстрирует потенциал интеграции визуальных данных для повышения производительности и универсальности моделей в реальных приложениях.

## Архитектура Phi-3 Vision

Архитектура модели — это мультимодальная версия Phi-3. Она обрабатывает как текстовые, так и визуальные данные, объединяя их в единую последовательность для комплексного понимания и генерации. Модель использует отдельные слои встраивания для текста и изображений. Текстовые токены преобразуются в плотные векторы, а изображения проходят через CLIP vision модель для извлечения признаков. Эти встраивания изображений затем проецируются в размерность, совпадающую с размерностью текстовых встраиваний, чтобы обеспечить бесшовную интеграцию.

## Интеграция текстовых и визуальных встраиваний

Специальные токены в текстовой последовательности указывают, где должны быть вставлены встраивания изображений. Во время обработки эти специальные токены заменяются соответствующими встраиваниями изображений, позволяя модели работать с текстом и изображениями как с единой последовательностью. Промпт для нашего набора данных форматируется с использованием специального токена <|image|> следующим образом:

```python
text = f"<|user|>\n<|image_1|>What is shown in this image?<|end|><|assistant|>\nProduct: {row['title']}, Category: {row['category3_code']}, Full Price: {row['full_price']}<|end|>"
```

## Пример кода
- [Phi-3-Vision Training Script](../../../../code/03.Finetuning/Phi-3-vision-Trainingscript.py)
- [Weights and Bias Example walkthrough](https://wandb.ai/byyoung3/mlnews3/reports/How-to-fine-tune-Phi-3-vision-on-a-custom-dataset--Vmlldzo4MTEzMTg3)

**Prohlášení o vyloučení odpovědnosti**:  
Tento dokument byl přeložen pomocí AI překladatelské služby [Co-op Translator](https://github.com/Azure/co-op-translator). Přestože usilujeme o přesnost, mějte prosím na paměti, že automatické překlady mohou obsahovat chyby nebo nepřesnosti. Původní dokument v jeho rodném jazyce by měl být považován za autoritativní zdroj. Pro kritické informace se doporučuje profesionální lidský překlad. Nejsme odpovědní za jakékoliv nedorozumění nebo nesprávné výklady vyplývající z použití tohoto překladu.