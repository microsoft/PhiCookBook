### Παράδειγμα Σεναρίου

Φανταστείτε ότι έχετε μια εικόνα (`demo.png`) και θέλετε να δημιουργήσετε κώδικα Python που επεξεργάζεται αυτή την εικόνα και αποθηκεύει μια νέα έκδοσή της (`phi-3-vision.jpg`).

Ο παραπάνω κώδικας αυτοματοποιεί αυτή τη διαδικασία με τα εξής βήματα:

1. Ρύθμιση του περιβάλλοντος και των απαραίτητων ρυθμίσεων.
2. Δημιουργία ενός prompt που δίνει οδηγίες στο μοντέλο να δημιουργήσει τον απαιτούμενο κώδικα Python.
3. Αποστολή του prompt στο μοντέλο και συλλογή του παραγόμενου κώδικα.
4. Εξαγωγή και εκτέλεση του παραγόμενου κώδικα.
5. Εμφάνιση της αρχικής και της επεξεργασμένης εικόνας.

Αυτή η προσέγγιση αξιοποιεί τη δύναμη της τεχνητής νοημοσύνης για να αυτοματοποιήσει εργασίες επεξεργασίας εικόνας, καθιστώντας πιο εύκολη και γρήγορη την επίτευξη των στόχων σας.

[Sample Code Solution](../../../../../../code/06.E2E/E2E_Nvidia_NIM_Phi3_Vision.ipynb)

Ας αναλύσουμε βήμα προς βήμα τι κάνει ο συνολικός κώδικας:

1. **Εγκατάσταση Απαιτούμενου Πακέτου**:
    ```python
    !pip install langchain_nvidia_ai_endpoints -U
    ```
    Αυτή η εντολή εγκαθιστά το πακέτο `langchain_nvidia_ai_endpoints`, διασφαλίζοντας ότι είναι η πιο πρόσφατη έκδοση.

2. **Εισαγωγή Απαραίτητων Μονάδων**:
    ```python
    from langchain_nvidia_ai_endpoints import ChatNVIDIA
    import getpass
    import os
    import base64
    ```
    Αυτές οι εισαγωγές φέρνουν τις απαραίτητες μονάδες για την αλληλεπίδραση με τα NVIDIA AI endpoints, την ασφαλή διαχείριση κωδικών, την αλληλεπίδραση με το λειτουργικό σύστημα και την κωδικοποίηση/αποκωδικοποίηση δεδομένων σε μορφή base64.

3. **Ρύθμιση Κλειδιού API**:
    ```python
    if not os.getenv("NVIDIA_API_KEY"):
        os.environ["NVIDIA_API_KEY"] = getpass.getpass("Enter your NVIDIA API key: ")
    ```
    Αυτός ο κώδικας ελέγχει αν έχει οριστεί η μεταβλητή περιβάλλοντος `NVIDIA_API_KEY`. Αν όχι, ζητά από τον χρήστη να εισάγει με ασφάλεια το κλειδί API.

4. **Ορισμός Μοντέλου και Διαδρομής Εικόνας**:
    ```python
    model = 'microsoft/phi-3-vision-128k-instruct'
    chat = ChatNVIDIA(model=model)
    img_path = './imgs/demo.png'
    ```
    Εδώ ορίζεται το μοντέλο που θα χρησιμοποιηθεί, δημιουργείται ένα στιγμιότυπο της κλάσης `ChatNVIDIA` με το συγκεκριμένο μοντέλο και ορίζεται η διαδρομή προς το αρχείο της εικόνας.

5. **Δημιουργία Κειμενικού Prompt**:
    ```python
    text = "Please create Python code for image, and use plt to save the new picture under imgs/ and name it phi-3-vision.jpg."
    ```
    Ορίζεται ένα κειμενικό prompt που δίνει οδηγίες στο μοντέλο να δημιουργήσει κώδικα Python για την επεξεργασία μιας εικόνας.

6. **Κωδικοποίηση Εικόνας σε Base64**:
    ```python
    with open(img_path, "rb") as f:
        image_b64 = base64.b64encode(f.read()).decode()
    image = f'<img src="data:image/png;base64,{image_b64}" />'
    ```
    Αυτός ο κώδικας διαβάζει το αρχείο της εικόνας, το κωδικοποιεί σε base64 και δημιουργεί μια ετικέτα HTML εικόνας με τα κωδικοποιημένα δεδομένα.

7. **Συνδυασμός Κειμένου και Εικόνας στο Prompt**:
    ```python
    prompt = f"{text} {image}"
    ```
    Εδώ συνδυάζεται το κειμενικό prompt και η ετικέτα HTML της εικόνας σε ένα ενιαίο κείμενο.

8. **Δημιουργία Κώδικα με Χρήση του ChatNVIDIA**:
    ```python
    code = ""
    for chunk in chat.stream(prompt):
        print(chunk.content, end="")
        code += chunk.content
    ```
    Αυτός ο κώδικας στέλνει το prompt στο μοντέλο `ChatNVIDIA` και συλλέγει τον παραγόμενο κώδικα σε κομμάτια, εκτυπώνοντας και προσθέτοντας κάθε κομμάτι στη μεταβλητή `code`.

9. **Εξαγωγή Κώδικα Python από το Παραγόμενο Περιεχόμενο**:
    ```python
    begin = code.index('```python') + 9
    code = code[begin:]
    end = code.index('```')
    code = code[:end]
    ```
    Εδώ εξάγεται ο πραγματικός κώδικας Python από το παραγόμενο περιεχόμενο αφαιρώντας τη μορφοποίηση markdown.

10. **Εκτέλεση του Παραγόμενου Κώδικα**:
    ```python
    import subprocess
    result = subprocess.run(["python", "-c", code], capture_output=True)
    ```
    Εκτελείται ο εξαγόμενος κώδικας Python ως subprocess και καταγράφεται η έξοδός του.

11. **Εμφάνιση Εικόνων**:
    ```python
    from IPython.display import Image, display
    display(Image(filename='./imgs/phi-3-vision.jpg'))
    display(Image(filename='./imgs/demo.png'))
    ```
    Αυτές οι γραμμές εμφανίζουν τις εικόνες χρησιμοποιώντας το module `IPython.display`.

**Αποποίηση ευθυνών**:  
Αυτό το έγγραφο έχει μεταφραστεί χρησιμοποιώντας την υπηρεσία αυτόματης μετάφρασης AI [Co-op Translator](https://github.com/Azure/co-op-translator). Παρόλο που επιδιώκουμε την ακρίβεια, παρακαλούμε να γνωρίζετε ότι οι αυτόματες μεταφράσεις ενδέχεται να περιέχουν λάθη ή ανακρίβειες. Το πρωτότυπο έγγραφο στη γλώσσα του θεωρείται η αυθεντική πηγή. Για κρίσιμες πληροφορίες, συνιστάται επαγγελματική ανθρώπινη μετάφραση. Δεν φέρουμε ευθύνη για τυχόν παρεξηγήσεις ή λανθασμένες ερμηνείες που προκύπτουν από τη χρήση αυτής της μετάφρασης.