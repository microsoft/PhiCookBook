<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "4164123a700fecd535d850f09506d72a",
  "translation_date": "2025-07-16T16:25:18+00:00",
  "source_file": "code/04.Finetuning/olive-ort-example/README.md",
  "language_code": "mr"
}
-->
# Olive рд╡рд╛рдкрд░реВрди Phi3 рдЪреЗ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд░рд╛

рдпрд╛ рдЙрджрд╛рд╣рд░рдгрд╛рдд рддреБрдореНрд╣реА Olive рд╡рд╛рдкрд░реВрди:

1. LoRA рдЕтАНреЕрдбреЙрдкреНрдЯрд░ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░реВрди рд╡рд╛рдХреНрдпрд╛рдВрд╢рд╛рдВрдирд╛ Sad, Joy, Fear, Surprise рдордзреНрдпреЗ рд╡рд░реНрдЧреАрдХреГрдд рдХрд░рд╛рд▓.
1. рдЕтАНреЕрдбреЙрдкреНрдЯрд░рдЪреЗ рд╡рдЬрди рдмреЗрд╕ рдореЙрдбреЗрд▓рдордзреНрдпреЗ рдорд░реНрдЬ рдХрд░рд╛рд▓.
1. рдореЙрдбреЗрд▓рдЪреЗ рдСрдкреНрдЯрд┐рдорд╛рдпрдЭреЗрд╢рди рдЖрдгрд┐ Quantize рдХрд░реВрди `int4` рдордзреНрдпреЗ рд░реВрдкрд╛рдВрддрд░ рдХрд░рд╛рд▓.

рдЖрдореНрд╣реА рддреБрдореНрд╣рд╛рд▓рд╛ ONNX Runtime (ORT) Generate API рд╡рд╛рдкрд░реВрди рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХреЗрд▓реЗрд▓реЗ рдореЙрдбреЗрд▓ рдХрд╕реЗ рдЗрдиреНрдлрд░ рдХрд░рд╛рдпрдЪреЗ рддреЗрд╣реА рджрд╛рдЦрд╡реВ.

> **тЪая╕П рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧрд╕рд╛рдареА, рддреБрдордЪреНрдпрд╛рдХрдбреЗ рдпреЛрдЧреНрдп GPU рдЕрд╕рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ - рдЙрджрд╛рд╣рд░рдгрд╛рд░реНрде, A10, V100, A100.**

## ЁЯТ╛ рдЗрдиреНрд╕реНрдЯреЙрд▓ рдХрд░рд╛

рдирд╡реАрди Python рд╡реНрд╣рд░реНрдЪреНрдпреБрдЕрд▓ рдПрдиреНрд╡реНрд╣рд╛рдпрд░реНрдирдореЗрдВрдЯ рддрдпрд╛рд░ рдХрд░рд╛ (рдЙрджрд╛рд╣рд░рдгрд╛рд░реНрде, `conda` рд╡рд╛рдкрд░реВрди):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

рдирдВрддрд░, Olive рдЖрдгрд┐ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рд╡рд░реНрдХрдлреНрд▓реЛ рд╕рд╛рдареА рдЖрд╡рд╢реНрдпрдХ dependencies рдЗрдиреНрд╕реНрдЯреЙрд▓ рдХрд░рд╛:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## ЁЯзк Olive рд╡рд╛рдкрд░реВрди Phi3 рдЪреЗ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд░рд╛
[Olive рдХреЙрдиреНрдлрд┐рдЧрд░реЗрд╢рди рдлрд╛рдЗрд▓](../../../../../code/04.Finetuning/olive-ort-example/phrase-classification.json) рдордзреНрдпреЗ рдЦрд╛рд▓реАрд▓ *рд╡рд░реНрдХрдлреНрд▓реЛ* рдЖрдгрд┐ *рдкрд╛рд╕* рдЖрд╣реЗрдд:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

рд╕рд╛рд░рд╛рдВрд╢рд╛рдд, рд╣рд╛ рд╡рд░реНрдХрдлреНрд▓реЛ:

1. Phi3 рдЪреЗ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд░реЗрд▓ (150 рд╕реНрдЯреЗрдкреНрд╕рд╕рд╛рдареА, рдЬреЗ рддреБрдореНрд╣реА рдмрджрд▓реВ рд╢рдХрддрд╛) [dataset/data-classification.json](../../../../../code/04.Finetuning/olive-ort-example/dataset/dataset-classification.json) рдбреЗрдЯрд╛рдЪрд╛ рд╡рд╛рдкрд░ рдХрд░реВрди.
1. LoRA рдЕтАНреЕрдбреЙрдкреНрдЯрд░рдЪреЗ рд╡рдЬрди рдмреЗрд╕ рдореЙрдбреЗрд▓рдордзреНрдпреЗ рдорд░реНрдЬ рдХрд░реЗрд▓. рддреНрдпрд╛рдореБрд│реЗ ONNX рдлреЙрд░рдореЕрдЯрдордзреНрдпреЗ рдПрдХрдЪ рдореЙрдбреЗрд▓ рддрдпрд╛рд░ рд╣реЛрдИрд▓.
1. Model Builder рдореЙрдбреЗрд▓рд▓рд╛ ONNX runtime рд╕рд╛рдареА рдСрдкреНрдЯрд┐рдорд╛рдЗрдЭ рдХрд░реЗрд▓ рдЖрдгрд┐ `int4` рдордзреНрдпреЗ Quantize рдХрд░реЗрд▓.

рд╡рд░реНрдХрдлреНрд▓реЛ рдЪрд╛рд▓рд╡рдгреНрдпрд╛рд╕рд╛рдареА, рдЦрд╛рд▓реАрд▓ рдХрдорд╛рдВрдб рд╡рд╛рдкрд░рд╛:

```bash
olive run --config phrase-classification.json
```

Olive рдкреВрд░реНрдг рдЭрд╛рд▓реНрдпрд╛рд╡рд░, рддреБрдордЪреЗ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЭреНрдб `int4` рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХреЗрд▓реЗрд▓реЗ Phi3 рдореЙрдбреЗрд▓ рдпреЗрдереЗ рдЙрдкрд▓рдмреНрдз рдЕрд╕реЗрд▓: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`.

## ЁЯзСтАНЁЯТ╗ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХреЗрд▓реЗрд▓реЗ Phi3 рддреБрдордЪреНрдпрд╛ рдЕтАНреЕрдкреНрд▓рд┐рдХреЗрд╢рдирдордзреНрдпреЗ рдЗрдВрдЯрд┐рдЧреНрд░реЗрдЯ рдХрд░рд╛

рдЕтАНреЕрдк рдЪрд╛рд▓рд╡рдгреНрдпрд╛рд╕рд╛рдареА:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

рдпрд╛ рдкреНрд░рддрд┐рд╕рд╛рджрд╛рдд рд╡рд╛рдХреНрдпрд╛рдВрд╢рд╛рдЪрд╛ рдПрдХрдЪ рд╢рдмреНрдж рд╡рд░реНрдЧреАрдХрд░рдг рдЕрд╕рд╛рд╡рд╛ (Sad/Joy/Fear/Surprise).

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рд╣рд╛ рджрд╕реНрддрдРрд╡рдЬ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рд╡рд╛рдкрд░реВрди рдЕрдиреБрд╡рд╛рджрд┐рдд рдХреЗрд▓рд╛ рдЖрд╣реЗ. рдЖрдореНрд╣реА рдЕрдЪреВрдХрддреЗрд╕рд╛рдареА рдкреНрд░рдпрддреНрдирд╢реАрд▓ рдЕрд╕рд▓реЛ рддрд░реА, рдХреГрдкрдпрд╛ рд▓рдХреНрд╖рд╛рдд рдШреНрдпрд╛ рдХреА рд╕реНрд╡рдпрдВрдЪрд▓рд┐рдд рдЕрдиреБрд╡рд╛рджрд╛рдВрдордзреНрдпреЗ рдЪреБрдХрд╛ рдХрд┐рдВрд╡рд╛ рдЕрдЪреВрдХрддреЗрдЪреА рдХрдорддрд░рддрд╛ рдЕрд╕реВ рд╢рдХрддреЗ. рдореВрд│ рджрд╕реНрддрдРрд╡рдЬ рддреНрдпрд╛рдЪреНрдпрд╛ рд╕реНрдерд╛рдирд┐рдХ рднрд╛рд╖реЗрдд рдЕрдзрд┐рдХреГрдд рд╕реНрд░реЛрдд рдорд╛рдирд▓рд╛ рдЬрд╛рд╡рд╛. рдорд╣рддреНрддреНрд╡рд╛рдЪреНрдпрд╛ рдорд╛рд╣рд┐рддреАрд╕рд╛рдареА рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡реА рдЕрдиреБрд╡рд╛рдж рдХрд░рдгреНрдпрд╛рдЪреА рд╢рд┐рдлрд╛рд░рд╕ рдХреЗрд▓реА рдЬрд╛рддреЗ. рдпрд╛ рдЕрдиреБрд╡рд╛рджрд╛рдЪреНрдпрд╛ рд╡рд╛рдкрд░рд╛рдореБрд│реЗ рдЙрджреНрднрд╡рдгрд╛рд▒реНрдпрд╛ рдХреЛрдгрддреНрдпрд╛рд╣реА рдЧреИрд░рд╕рдордЬреБрддреА рдХрд┐рдВрд╡рд╛ рдЪреБрдХреАрдЪреНрдпрд╛ рдЕрд░реНрдерд▓рд╛рдЧреА рдЖрдореНрд╣реА рдЬрдмрд╛рдмрджрд╛рд░ рдирд╛рд╣реА.