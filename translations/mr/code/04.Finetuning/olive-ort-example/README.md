<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "4164123a700fecd535d850f09506d72a",
  "translation_date": "2025-05-09T04:44:12+00:00",
  "source_file": "code/04.Finetuning/olive-ort-example/README.md",
  "language_code": "mr"
}
-->
# Olive рд╡рд╛рдкрд░реВрди Phi3 рдЪреЗ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд░рд╛

рдпрд╛ рдЙрджрд╛рд╣рд░рдгрд╛рдд рддреБрдореНрд╣реА Olive рд╡рд╛рдкрд░реВрди:

1. LoRA рдЕтАНреЕрдбреЙрдкреНрдЯрд░ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░реВрди рд╡рд╛рдХреНрдпреЗ Sad, Joy, Fear, Surprise рдордзреНрдпреЗ рд╡рд░реНрдЧреАрдХреГрдд рдХрд░рд╛рд▓.
1. рдЕтАНреЕрдбреЙрдкреНрдЯрд░рдЪреЗ рд╡рдЬрди рдмреЗрд╕ рдореЙрдбреЗрд▓рдордзреНрдпреЗ рдорд░реНрдЬ рдХрд░рд╛рд▓.
1. рдореЙрдбреЗрд▓рдЪреЗ рдСрдкреНрдЯрд┐рдорд╛рдпрдЭреЗрд╢рди рдЖрдгрд┐ рдХреНрд╡рд╛рдВрдЯрд╛рдпрдЭреЗрд╢рди `int4` рдордзреНрдпреЗ рдХрд░рд╛рд▓.

рдЖрдореНрд╣реА рддреБрдореНрд╣рд╛рд▓рд╛ ONNX Runtime (ORT) Generate API рд╡рд╛рдкрд░реВрди рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХреЗрд▓реЗрд▓реЗ рдореЙрдбреЗрд▓ рдХрд╕реЗ рдЗрдиреНрдлрд░рдиреНрд╕ рдХрд░рд╛рдпрдЪреЗ рддреЗрд╣реА рджрд╛рдЦрд╡реВ.

> **тЪая╕П рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧрд╕рд╛рдареА, рддреБрдордЪреНрдпрд╛рдХрдбреЗ рдпреЛрдЧреНрдп GPU рдЕрд╕рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ - рдЙрджрд╛. A10, V100, A100.**

## ЁЯТ╛ рдЗрдиреНрд╕реНрдЯреЙрд▓ рдХрд░рд╛

рдирд╡реАрди Python рд╡реНрд╣рд░реНрдЪреНрдпреБрдЕрд▓ рдПрдиреНрд╡реНрд╣рд╛рдпрд░реНрдирдореЗрдВрдЯ рддрдпрд╛рд░ рдХрд░рд╛ (рдЙрджрд╛. `conda` рд╡рд╛рдкрд░реВрди):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

рдирдВрддрд░, Olive рдЖрдгрд┐ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рд╡рд░реНрдХрдлреНрд▓реЛ рд╕рд╛рдареА рдЖрд╡рд╢реНрдпрдХ dependencies рдЗрдиреНрд╕реНрдЯреЙрд▓ рдХрд░рд╛:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## ЁЯзк Olive рд╡рд╛рдкрд░реВрди Phi3 рдЪреЗ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд░рд╛
[Olive рдХреЙрдиреНрдлрд┐рдЧрд░реЗрд╢рди рдлрд╛рдЗрд▓](../../../../../code/04.Finetuning/olive-ort-example/phrase-classification.json) рдордзреНрдпреЗ рдЦрд╛рд▓реАрд▓ *workflow* рдЖрдгрд┐ *passes* рдЖрд╣реЗрдд:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

рд╕рд╛рдорд╛рдиреНрдпрддрдГ, рд╣рд╛ рд╡рд░реНрдХрдлреНрд▓реЛ:

1. Phi3 рдЪреЗ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд░реЗрд▓ (150 рд╕реНрдЯреЗрдкреНрд╕рд╕рд╛рдареА, рддреБрдореНрд╣реА рдмрджрд▓реВ рд╢рдХрддрд╛) [dataset/data-classification.json](../../../../../code/04.Finetuning/olive-ort-example/dataset/dataset-classification.json) рдбреЗрдЯрд╛ рд╡рд╛рдкрд░реВрди.
1. LoRA рдЕтАНреЕрдбреЙрдкреНрдЯрд░рдЪреЗ рд╡рдЬрди рдмреЗрд╕ рдореЙрдбреЗрд▓рдордзреНрдпреЗ рдорд░реНрдЬ рдХрд░реЗрд▓. рдпрд╛рдореБрд│реЗ ONNX рдлреЙрд░рдореЕрдЯрдордзреНрдпреЗ рдПрдХрдЪ рдореЙрдбреЗрд▓ рдЖрд░реНрдЯрд┐рдлреЕрдХреНрдЯ рддрдпрд╛рд░ рд╣реЛрдИрд▓.
1. Model Builder рдореЙрдбреЗрд▓ ONNX runtime рд╕рд╛рдареА рдСрдкреНрдЯрд┐рдорд╛рдЗрдЭ рдХрд░реЗрд▓ *рдЖрдгрд┐* рдореЙрдбреЗрд▓ `int4` рдордзреНрдпреЗ рдХреНрд╡рд╛рдВрдЯрд╛рдЗрдЭ рдХрд░реЗрд▓.

рд╡рд░реНрдХрдлреНрд▓реЛ рдЪрд╛рд▓рд╡рдгреНрдпрд╛рд╕рд╛рдареА, рдЦрд╛рд▓реАрд▓ рдХрдорд╛рдВрдб рд╡рд╛рдкрд░рд╛:

```bash
olive run --config phrase-classification.json
```

Olive рдкреВрд░реНрдг рдЭрд╛рд▓реНрдпрд╛рдирдВрддрд░, рддреБрдордЪреЗ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЭ рдХреЗрд▓реЗрд▓реЗ `int4` рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХреЗрд▓реЗрд▓реЗ Phi3 рдореЙрдбреЗрд▓ рдпреЗрдереЗ рдЙрдкрд▓рдмреНрдз рдЕрд╕реЗрд▓: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`.

## ЁЯзСтАНЁЯТ╗ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХреЗрд▓реЗрд▓реЗ Phi3 рддреБрдордЪреНрдпрд╛ рдЕтАНреЕрдкреНрд▓рд┐рдХреЗрд╢рдирдордзреНрдпреЗ рдЗрдВрдЯреАрдЧреНрд░реЗрдЯ рдХрд░рд╛

рдЕтАНреЕрдк рдЪрд╛рд▓рд╡рдгреНрдпрд╛рд╕рд╛рдареА:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

рд╣рд╛ рдкреНрд░рддрд┐рд╕рд╛рдж рд╡рд╛рдХреНрдпрд╛рдЪрд╛ рдПрдХ рд╢рдмреНрдж рд╡рд░реНрдЧреАрдХрд░рдг рдЕрд╕реЗрд▓ (Sad/Joy/Fear/Surprise).

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рд╣рд╛ рджрд╕реНрддрдРрд╡рдЬ AI рднрд╛рд╖рд╛рдВрддрд░ рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рд╡рд╛рдкрд░реВрди рднрд╛рд╖рд╛рдВрддрд░рд┐рдд рдХреЗрд▓рд╛ рдЖрд╣реЗ. рдЖрдореНрд╣реА рдЕрдЪреВрдХрддреЗрд╕рд╛рдареА рдкреНрд░рдпрддреНрди рдХрд░рддреЛ, рддрд░реА рдХреГрдкрдпрд╛ рд▓рдХреНрд╖рд╛рдд рдареЗрд╡рд╛ рдХреА рд╕реНрд╡рдпрдВрдЪрд▓рд┐рдд рднрд╛рд╖рд╛рдВрддрд░рд╛рдВрдордзреНрдпреЗ рдЪреБрдХрд╛ рдХрд┐рдВрд╡рд╛ рдЕрдЪреВрдХрддреЗрдд рдлрд░рдХ рдЕрд╕реВ рд╢рдХрддреЛ. рдореВрд│ рджрд╕реНрддрдРрд╡рдЬ рддреНрдпрд╛рдЪреНрдпрд╛ рдореВрд│ рднрд╛рд╖реЗрдд рдЕрдзрд┐рдХреГрдд рд╕реНрд░реЛрдд рдореНрд╣рдгреВрди рдорд╛рдирд▓рд╛ рдЬрд╛рд╡рд╛. рдорд╣рддреНрддреНрд╡рд╛рдЪреНрдпрд╛ рдорд╛рд╣рд┐рддреАрд╕рд╛рдареА рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡реА рднрд╛рд╖рд╛рдВрддрд░рд╛рдЪреА рд╢рд┐рдлрд╛рд░рд╕ рдХреЗрд▓реА рдЬрд╛рддреЗ. рдпрд╛ рднрд╛рд╖рд╛рдВрддрд░рд╛рдЪрд╛ рд╡рд╛рдкрд░ рдХреЗрд▓реНрдпрд╛рдореБрд│реЗ рдЙрджреНрднрд╡рд▓реЗрд▓реНрдпрд╛ рдХреЛрдгрддреНрдпрд╛рд╣реА рдЧреИрд░рд╕рдордЬреБрддреА рдХрд┐рдВрд╡рд╛ рдЪреБрдХреАрд╕рд╛рдареА рдЖрдореНрд╣реА рдЬрдмрд╛рдмрджрд╛рд░ рдирд╛рд╣реА.