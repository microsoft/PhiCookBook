<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "4164123a700fecd535d850f09506d72a",
  "translation_date": "2025-05-09T04:31:11+00:00",
  "source_file": "code/03.Finetuning/olive-ort-example/README.md",
  "language_code": "mr"
}
-->
# Olive рд╡рд╛рдкрд░реВрди Phi3 рдЪреЗ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд░рд╛

рдпрд╛ рдЙрджрд╛рд╣рд░рдгрд╛рдд рддреБрдореНрд╣реА Olive рд╡рд╛рдкрд░реВрди:

1. LoRA рдЕтАНреЕрдбреЙрдкреНрдЯрд░ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░реВрди рд╡рд╛рдХреНрдпрд╛рдВрд╢рд╛рдВрдирд╛ Sad, Joy, Fear, Surprise рдордзреНрдпреЗ рд╡рд░реНрдЧреАрдХреГрдд рдХрд░рд╛рд▓.
1. рдЕтАНреЕрдбреЙрдкреНрдЯрд░рдЪреЗ рд╡рдЬрди рдмреЗрд╕ рдореЙрдбреЗрд▓рдордзреНрдпреЗ рдорд░реНрдЬ рдХрд░рд╛рд▓.
1. рдореЙрдбреЗрд▓рдЪреЗ рдСрдкреНрдЯрд┐рдорд╛рдпрдЭреЗрд╢рди рдЖрдгрд┐ Quantize рдХрд░реВрди `int4` рдордзреНрдпреЗ рд░реВрдкрд╛рдВрддрд░ рдХрд░рд╛рд▓.

рдЖрдореНрд╣реА рддреБрдореНрд╣рд╛рд▓рд╛ ONNX Runtime (ORT) Generate API рд╡рд╛рдкрд░реВрди рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХреЗрд▓реЗрд▓реЗ рдореЙрдбреЗрд▓ рдХрд╕реЗ рдЗрдиреНрдлрд░рдиреНрд╕ рдХрд░рд╛рдпрдЪреЗ рддреЗ рджреЗрдЦреАрд▓ рджрд╛рдЦрд╡реВ.

> **тЪая╕П рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧрд╕рд╛рдареА, рддреБрдордЪреНрдпрд╛рдХрдбреЗ рдпреЛрдЧреНрдп GPU рдЕрд╕рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ - рдЙрджрд╛рд╣рд░рдгрд╛рд░реНрде, A10, V100, A100.**

## ЁЯТ╛ рдЗрдиреНрд╕реНрдЯреЙрд▓ рдХрд░рд╛

рдирд╡реАрди Python рд╡реНрд╣рд░реНрдЪреНрдпреБрдЕрд▓ рдПрдиреНрд╡реНрд╣рд╛рдпрд░реНрдирдореЗрдВрдЯ рддрдпрд╛рд░ рдХрд░рд╛ (рдЙрджрд╛рд╣рд░рдгрд╛рд░реНрде, `conda` рд╡рд╛рдкрд░реВрди):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

рдирдВрддрд░, Olive рдЖрдгрд┐ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рд╡рд░реНрдХрдлреНрд▓реЛ рд╕рд╛рдареА рдЖрд╡рд╢реНрдпрдХ dependencies рдЗрдиреНрд╕реНрдЯреЙрд▓ рдХрд░рд╛:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## ЁЯзк Olive рд╡рд╛рдкрд░реВрди Phi3 рдЪреЗ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд░рд╛
[Olive рдХреЙрдиреНрдлрд┐рдЧрд░реЗрд╢рди рдлрд╛рдЗрд▓](../../../../../code/03.Finetuning/olive-ort-example/phrase-classification.json) рдордзреНрдпреЗ рдЦрд╛рд▓реАрд▓ *workflow* рдЖрдгрд┐ *passes* рдЖрд╣реЗрдд:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

рд╕рд╛рдзрд╛рд░рдгрдкрдгреЗ, рд╣рд╛ рд╡рд░реНрдХрдлреНрд▓реЛ:

1. Phi3 рд▓рд╛ 150 рд╕реНрдЯреЗрдкреНрд╕рд╕рд╛рдареА (рддреБрдореНрд╣реА рдмрджрд▓реВ рд╢рдХрддрд╛) [dataset/data-classification.json](../../../../../code/03.Finetuning/olive-ort-example/dataset/dataset-classification.json) рдбреЗрдЯрд╛ рд╡рд╛рдкрд░реВрди рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░реЗрд▓.
1. LoRA рдЕтАНреЕрдбреЙрдкреНрдЯрд░рдЪреЗ рд╡рдЬрди рдмреЗрд╕ рдореЙрдбреЗрд▓рдордзреНрдпреЗ рдорд░реНрдЬ рдХрд░реЗрд▓. рддреНрдпрд╛рдореБрд│реЗ рддреБрдореНрд╣рд╛рд▓рд╛ ONNX рдлреЙрд░рдореЕрдЯрдордзреАрд▓ рдПрдХрдЪ рдореЙрдбреЗрд▓ рдЖрд░реНрдЯрд┐рдлреЕрдХреНрдЯ рдорд┐рд│реЗрд▓.
1. Model Builder рдореЙрдбреЗрд▓рд▓рд╛ ONNX runtime рд╕рд╛рдареА рдСрдкреНрдЯрд┐рдорд╛рдЗрдЭ рдХрд░реЗрд▓ рдЖрдгрд┐ рдореЙрдбреЗрд▓рд▓рд╛ `int4` рдордзреНрдпреЗ quantize рдХрд░реЗрд▓.

рд╡рд░реНрдХрдлреНрд▓реЛ рдЪрд╛рд▓рд╡рдгреНрдпрд╛рд╕рд╛рдареА, рдЦрд╛рд▓реАрд▓ рдХрдорд╛рдВрдб рд╡рд╛рдкрд░рд╛:

```bash
olive run --config phrase-classification.json
```

Olive рдкреВрд░реНрдг рдЭрд╛рд▓реНрдпрд╛рдирдВрддрд░, рддреБрдордЪреЗ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЭреНрдб `int4` рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХреЗрд▓реЗрд▓реЗ Phi3 рдореЙрдбреЗрд▓ рдпреЗрдереЗ рдЙрдкрд▓рдмреНрдз рдЕрд╕реЗрд▓: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`.

## ЁЯзСтАНЁЯТ╗ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХреЗрд▓реЗрд▓реЗ Phi3 рддреБрдордЪреНрдпрд╛ рдЕтАНреЕрдкреНрд▓рд┐рдХреЗрд╢рдирдордзреНрдпреЗ рдЗрдВрдЯрд┐рдЧреНрд░реЗрдЯ рдХрд░рд╛

рдЕтАНреЕрдк рдЪрд╛рд▓рд╡рдгреНрдпрд╛рд╕рд╛рдареА:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

рд╣рд╛ рдкреНрд░рддрд┐рд╕рд╛рдж рд╡рд╛рдХреНрдпрд╛рдВрд╢рд╛рдЪрд╛ рдПрдХрдЪ рд╢рдмреНрдж рд╡рд░реНрдЧреАрдХрд░рдг рдЕрд╕рд╛рд╡рд╛ (Sad/Joy/Fear/Surprise).

**рд╕реВрдЪрдирд╛**:  
рд╣рд╛ рджрд╕реНрддрдРрд╡рдЬ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рд╡рд╛рдкрд░реВрди рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд░рдгреНрдпрд╛рдд рдЖрд▓рд╛ рдЖрд╣реЗ. рдЖрдореНрд╣реА рдЕрдЪреВрдХрддреЗрд╕рд╛рдареА рдкреНрд░рдпрддреНрди рдХрд░рддреЛ, рдкрд░рдВрддреБ рдХреГрдкрдпрд╛ рд▓рдХреНрд╖рд╛рдд рдареЗрд╡рд╛ рдХреА рд╕реНрд╡рдпрдВрдЪрд▓рд┐рдд рдЕрдиреБрд╡рд╛рджрд╛рдВрдордзреНрдпреЗ рдЪреБрдХрд╛ рдХрд┐рдВрд╡рд╛ рдЕрдЪреВрдХрддреЗрдЪреНрдпрд╛ рддреНрд░реБрдЯреА рдЕрд╕реВ рд╢рдХрддрд╛рдд. рдореВрд│ рджрд╕реНрддрдРрд╡рдЬ рддреНрдпрд╛рдЪреНрдпрд╛ рд╕реНрдерд╛рдирд┐рдХ рднрд╛рд╖реЗрдд рдЕрдзрд┐рдХреГрдд рд╕реНрд░реЛрдд рдореНрд╣рдгреВрди рд╡рд┐рдЪрд╛рд░рд╛рдд рдШреНрдпрд╛рд╡рд╛. рдорд╣рддреНрддреНрд╡рд╛рдЪреНрдпрд╛ рдорд╛рд╣рд┐рддреАрд╕рд╛рдареА рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡реА рдЕрдиреБрд╡рд╛рдж рд╢рд┐рдлрд╛рд░рд╕реАрдп рдЖрд╣реЗ. рдпрд╛ рдЕрдиреБрд╡рд╛рджрд╛рдЪреНрдпрд╛ рд╡рд╛рдкрд░рд╛рдореБрд│реЗ рдЙрджреНрднрд╡рд▓реЗрд▓реНрдпрд╛ рдХреЛрдгрддреНрдпрд╛рд╣реА рдЧреИрд░рд╕рдордЬреБрддреА рдХрд┐рдВрд╡рд╛ рдЪреБрдХреАрдЪреНрдпрд╛ рдЕрд░реНрдерд▓рд╛рдЧреА рдЖрдореНрд╣реА рдЬрдмрд╛рдмрджрд╛рд░ рдирд╛рд╣реА.