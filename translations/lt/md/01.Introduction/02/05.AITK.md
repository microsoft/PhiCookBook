# Phi šeima AITK

[AI Toolkit for VS Code](https://marketplace.visualstudio.com/items?itemName=ms-windows-ai-studio.windows-ai-studio) supaprastina generatyvios AI programų kūrimą, sujungdamas pažangiausius AI kūrimo įrankius ir modelius iš Azure AI Foundry katalogo bei kitų katalogų, tokių kaip Hugging Face. Galėsite naršyti AI modelių katalogą, kurį palaiko GitHub Models ir Azure AI Foundry Model Catalogs, atsisiųsti juos lokaliai arba nuotoliniu būdu, pritaikyti, testuoti ir naudoti savo programoje.

AI Toolkit Preview veiks lokaliai. Vietinis modelio įvertinimas arba pritaikymas priklauso nuo pasirinkto modelio, ir jums gali prireikti GPU, pavyzdžiui, NVIDIA CUDA GPU. Taip pat galite tiesiogiai naudoti GitHub Models su AITK.

## Pradžia

[Sužinokite daugiau apie Windows subsystem for Linux įdiegimą](https://learn.microsoft.com/windows/wsl/install?WT.mc_id=aiml-137032-kinfeylo)

ir [kaip pakeisti numatytąją distribuciją](https://learn.microsoft.com/windows/wsl/install#change-the-default-linux-distribution-installed).

[AI Toolkit GitHub Repo](https://github.com/microsoft/vscode-ai-toolkit/)

- Windows, Linux, macOS
  
- Norint pritaikyti modelius tiek Windows, tiek Linux, jums reikės Nvidia GPU. Be to, **Windows** reikalauja Linux subsystem su Ubuntu distribucija 18.4 ar naujesne. [Sužinokite daugiau apie Windows subsystem for Linux įdiegimą](https://learn.microsoft.com/windows/wsl/install) ir [kaip pakeisti numatytąją distribuciją](https://learn.microsoft.com/windows/wsl/install#change-the-default-linux-distribution-installed).

### AI Toolkit įdiegimas

AI Toolkit pateikiamas kaip [Visual Studio Code Extension](https://code.visualstudio.com/docs/setup/additional-components#_vs-code-extensions), todėl pirmiausia reikia įdiegti [VS Code](https://code.visualstudio.com/docs/setup/windows?WT.mc_id=aiml-137032-kinfeylo) ir atsisiųsti AI Toolkit iš [VS Marketplace](https://marketplace.visualstudio.com/items?itemName=ms-windows-ai-studio.windows-ai-studio).
[AI Toolkit yra prieinamas Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=ms-windows-ai-studio.windows-ai-studio) ir gali būti įdiegtas kaip bet kuris kitas VS Code plėtinys.

Jei nesate susipažinę su VS Code plėtinių įdiegimu, atlikite šiuos veiksmus:

### Prisijungimas

1. VS Code veiklos juostoje pasirinkite **Extensions**
1. Extensions paieškos juostoje įveskite "AI Toolkit"
1. Pasirinkite "AI Toolkit for Visual Studio code"
1. Pasirinkite **Install**

Dabar galite naudotis plėtiniu!

Jums bus pasiūlyta prisijungti prie GitHub, todėl spustelėkite "Allow", kad tęstumėte. Būsite nukreipti į GitHub prisijungimo puslapį.

Prisijunkite ir sekite proceso žingsnius. Po sėkmingo užbaigimo būsite nukreipti atgal į VS Code.

Kai plėtinys bus įdiegtas, veiklos juostoje pasirodys AI Toolkit piktograma.

Pažvelkime į galimus veiksmus!

### Galimi veiksmai

Pagrindinis AI Toolkit šoninis meniu suskirstytas į  

- **Models**
- **Resources**
- **Playground**  
- **Fine-tuning**
- **Evaluation**

Šie veiksmai yra prieinami Resources skiltyje. Norėdami pradėti, pasirinkite **Model Catalog**.

### Modelio atsisiuntimas iš katalogo

Paleidus AI Toolkit iš VS Code šoninio meniu, galite pasirinkti šias parinktis:

![AI toolkit model catalog](../../../../../imgs/01/02/05/AItoolkitmodel_catalog.png)

- Raskite palaikomą modelį iš **Model Catalog** ir atsisiųskite lokaliai
- Testuokite modelio įvertinimą **Model Playground**
- Pritaikykite modelį lokaliai arba nuotoliniu būdu **Model Fine-tuning**
- Įdiekite pritaikytus modelius debesyje per AI Toolkit komandų paletę
- Įvertinkite modelius

> [!NOTE]
>
> **GPU Vs CPU**
>
> Pastebėsite, kad modelio kortelėse nurodomas modelio dydis, platforma ir akceleratoriaus tipas (CPU, GPU). Norint optimizuoti našumą **Windows įrenginiuose, turinčiuose bent vieną GPU**, pasirinkite modelio versijas, kurios skirtos tik Windows.
>
> Tai užtikrina, kad turite modelį, optimizuotą DirectML akceleratoriui.
>
> Modelių pavadinimai yra tokio formato:
>
> - `{model_name}-{accelerator}-{quantization}-{format}`.
>
>Norėdami patikrinti, ar jūsų Windows įrenginys turi GPU, atidarykite **Task Manager** ir pasirinkite **Performance** skirtuką. Jei turite GPU, jie bus išvardyti pavadinimais, tokiais kaip "GPU 0" arba "GPU 1".

### Modelio paleidimas Playground

Kai visi parametrai nustatyti, spustelėkite **Generate Project**.

Kai modelis bus atsisiųstas, pasirinkite **Load in Playground** modelio kortelėje kataloge:

- Pradėkite modelio atsisiuntimą
- Įdiekite visas būtinas priklausomybes
- Sukurkite VS Code darbo aplinką

![Load model in playground](../../../../../imgs/01/02/05/AItoolkitload_model_into_playground.png)

### REST API naudojimas jūsų programoje 

AI Toolkit turi vietinį REST API web serverį **5272 porte**, kuris naudoja [OpenAI chat completions formatą](https://platform.openai.com/docs/api-reference/chat/create). 

Tai leidžia testuoti jūsų programą lokaliai, nereikalaujant debesų AI modelio paslaugos. Pavyzdžiui, šis JSON failas parodo, kaip sukonfigūruoti užklausos kūną:

```json
{
    "model": "Phi-4",
    "messages": [
        {
            "role": "user",
            "content": "what is the golden ratio?"
        }
    ],
    "temperature": 0.7,
    "top_p": 1,
    "top_k": 10,
    "max_tokens": 100,
    "stream": true
}
```

REST API galite testuoti naudodami (pvz.) [Postman](https://www.postman.com/) arba CURL (Client URL) įrankį:

```bash
curl -vX POST http://127.0.0.1:5272/v1/chat/completions -H 'Content-Type: application/json' -d @body.json
```

### OpenAI klientų bibliotekos naudojimas Python

```python
from openai import OpenAI

client = OpenAI(
    base_url="http://127.0.0.1:5272/v1/", 
    api_key="x" # required for the API but not used
)

chat_completion = client.chat.completions.create(
    messages=[
        {
            "role": "user",
            "content": "what is the golden ratio?",
        }
    ],
    model="Phi-4",
)

print(chat_completion.choices[0].message.content)
```

### Azure OpenAI klientų bibliotekos naudojimas .NET

Pridėkite [Azure OpenAI klientų biblioteką .NET](https://www.nuget.org/packages/Azure.AI.OpenAI/) į savo projektą naudodami NuGet:

```bash
dotnet add {project_name} package Azure.AI.OpenAI --version 1.0.0-beta.17
```

Pridėkite C# failą, pavadintą **OverridePolicy.cs**, į savo projektą ir įklijuokite šį kodą:

```csharp
// OverridePolicy.cs
using Azure.Core.Pipeline;
using Azure.Core;

internal partial class OverrideRequestUriPolicy(Uri overrideUri)
    : HttpPipelineSynchronousPolicy
{
    private readonly Uri _overrideUri = overrideUri;

    public override void OnSendingRequest(HttpMessage message)
    {
        message.Request.Uri.Reset(_overrideUri);
    }
}
```

Toliau įklijuokite šį kodą į savo **Program.cs** failą:

```csharp
// Program.cs
using Azure.AI.OpenAI;

Uri localhostUri = new("http://localhost:5272/v1/chat/completions");

OpenAIClientOptions clientOptions = new();
clientOptions.AddPolicy(
    new OverrideRequestUriPolicy(localhostUri),
    Azure.Core.HttpPipelinePosition.BeforeTransport);
OpenAIClient client = new(openAIApiKey: "unused", clientOptions);

ChatCompletionsOptions options = new()
{
    DeploymentName = "Phi-4",
    Messages =
    {
        new ChatRequestSystemMessage("You are a helpful assistant. Be brief and succinct."),
        new ChatRequestUserMessage("What is the golden ratio?"),
    }
};

StreamingResponse<StreamingChatCompletionsUpdate> streamingChatResponse
    = await client.GetChatCompletionsStreamingAsync(options);

await foreach (StreamingChatCompletionsUpdate chatChunk in streamingChatResponse)
{
    Console.Write(chatChunk.ContentUpdate);
}
```


## Modelio pritaikymas su AI Toolkit

- Pradėkite nuo modelio atradimo ir Playground.
- Modelio pritaikymas ir įvertinimas naudojant vietinius kompiuterinius resursus.
- Nuotolinis pritaikymas ir įvertinimas naudojant Azure resursus.

[Modelio pritaikymas su AI Toolkit](../../03.FineTuning/Finetuning_VSCodeaitoolkit.md)

## AI Toolkit Q&A ištekliai

Prašome kreiptis į mūsų [Q&A puslapį](https://github.com/microsoft/vscode-ai-toolkit/blob/main/archive/QA.md) dėl dažniausiai pasitaikančių problemų ir jų sprendimų.

---

**Atsakomybės apribojimas**:  
Šis dokumentas buvo išverstas naudojant AI vertimo paslaugą [Co-op Translator](https://github.com/Azure/co-op-translator). Nors stengiamės užtikrinti tikslumą, prašome atkreipti dėmesį, kad automatiniai vertimai gali turėti klaidų ar netikslumų. Originalus dokumentas jo gimtąja kalba turėtų būti laikomas autoritetingu šaltiniu. Kritinei informacijai rekomenduojama naudoti profesionalų žmogaus vertimą. Mes neprisiimame atsakomybės už nesusipratimus ar neteisingus interpretavimus, atsiradusius dėl šio vertimo naudojimo.