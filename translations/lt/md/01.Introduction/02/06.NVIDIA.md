## Phi šeima NVIDIA NIM

NVIDIA NIM – tai lengvai naudojamų mikroservisų rinkinys, sukurtas paspartinti generatyvinių AI modelių diegimą debesijoje, duomenų centruose ir darbo stotyse. NIM mikroservisai yra skirstomi pagal modelių šeimas ir atskirus modelius. Pavyzdžiui, NVIDIA NIM, skirtas dideliems kalbos modeliams (LLMs), suteikia galimybę įmonių programoms naudoti pažangiausius LLM modelius, užtikrinant neprilygstamus natūralios kalbos apdorojimo ir supratimo gebėjimus.

NIM leidžia IT ir DevOps komandoms savarankiškai talpinti didelius kalbos modelius (LLMs) savo valdomose aplinkose, tuo pačiu suteikiant kūrėjams standartizuotus API, kurie leidžia kurti galingus pagalbininkus, pokalbių robotus ir AI asistentus, galinčius transformuoti jų verslą. Pasinaudojant NVIDIA pažangia GPU akceleracija ir mastelio keitimo galimybėmis, NIM siūlo greičiausią kelią į išvedimą su neprilygstamu našumu.

Naudodami NVIDIA NIM galite atlikti išvedimą su Phi šeimos modeliais.

![nim](../../../../../imgs/01/02/06/Phi-NIM.png)

### **Pavyzdžiai - Phi-3-Vision NVIDIA NIM**

Įsivaizduokite, kad turite vaizdą (`demo.png`) ir norite sugeneruoti Python kodą, kuris apdorotų šį vaizdą ir išsaugotų naują jo versiją (`phi-3-vision.jpg`).

Aukščiau pateiktas kodas automatizuoja šį procesą:

1. Nustatydamas aplinką ir reikalingas konfigūracijas.
2. Sukurdamas užklausą, kuri nurodo modeliui sugeneruoti reikiamą Python kodą.
3. Siųsdamas užklausą modeliui ir surinkdamas sugeneruotą kodą.
4. Išskirdamas ir vykdydamas sugeneruotą kodą.
5. Parodydamas originalų ir apdorotą vaizdus.

Šis metodas pasitelkia AI galią automatizuoti vaizdų apdorojimo užduotis, padarydamas procesą lengvesnį ir greitesnį.

[Sprendimo kodo pavyzdys](../../../../../code/06.E2E/E2E_Nvidia_NIM_Phi3_Vision.ipynb)

Pažvelkime, ką visas kodas daro žingsnis po žingsnio:

1. **Įdiegti reikalingą paketą**:
    ```python
    !pip install langchain_nvidia_ai_endpoints -U
    ```
    Ši komanda įdiegia `langchain_nvidia_ai_endpoints` paketą, užtikrindama, kad jis yra naujausios versijos.

2. **Importuoti reikalingus modulius**:
    ```python
    from langchain_nvidia_ai_endpoints import ChatNVIDIA
    import getpass
    import os
    import base64
    ```
    Šie importai įtraukia reikalingus modulius, skirtus sąveikai su NVIDIA AI galiniais taškais, slaptažodžių saugiam tvarkymui, sąveikai su operacine sistema ir duomenų kodavimui/dekodavimui base64 formatu.

3. **Nustatyti API raktą**:
    ```python
    if not os.getenv("NVIDIA_API_KEY"):
        os.environ["NVIDIA_API_KEY"] = getpass.getpass("Enter your NVIDIA API key: ")
    ```
    Šis kodas patikrina, ar nustatytas aplinkos kintamasis `NVIDIA_API_KEY`. Jei ne, jis prašo vartotojo saugiai įvesti savo API raktą.

4. **Apibrėžti modelį ir vaizdo kelią**:
    ```python
    model = 'microsoft/phi-3-vision-128k-instruct'
    chat = ChatNVIDIA(model=model)
    img_path = './imgs/demo.png'
    ```
    Tai nustato naudojamą modelį, sukuria `ChatNVIDIA` instanciją su nurodytu modeliu ir apibrėžia vaizdo failo kelią.

5. **Sukurti tekstinę užklausą**:
    ```python
    text = "Please create Python code for image, and use plt to save the new picture under imgs/ and name it phi-3-vision.jpg."
    ```
    Tai apibrėžia tekstinę užklausą, nurodančią modeliui sugeneruoti Python kodą vaizdo apdorojimui.

6. **Kodavimas base64 formatu**:
    ```python
    with open(img_path, "rb") as f:
        image_b64 = base64.b64encode(f.read()).decode()
    image = f'<img src="data:image/png;base64,{image_b64}" />'
    ```
    Šis kodas nuskaito vaizdo failą, koduoja jį base64 formatu ir sukuria HTML vaizdo žymą su užkoduotais duomenimis.

7. **Sujungti tekstą ir vaizdą į užklausą**:
    ```python
    prompt = f"{text} {image}"
    ```
    Tai sujungia tekstinę užklausą ir HTML vaizdo žymą į vieną eilutę.

8. **Sugeneruoti kodą naudojant ChatNVIDIA**:
    ```python
    code = ""
    for chunk in chat.stream(prompt):
        print(chunk.content, end="")
        code += chunk.content
    ```
    Šis kodas siunčia užklausą `ChatNVIDIA` modeliui ir surenka sugeneruotą kodą dalimis, spausdindamas ir pridėdamas kiekvieną dalį prie `code` eilutės.

9. **Išskirti Python kodą iš sugeneruoto turinio**:
    ```python
    begin = code.index('```python') + 9
    code = code[begin:]
    end = code.index('```')
    code = code[:end]
    ```
    Tai išskiria faktinį Python kodą iš sugeneruoto turinio, pašalindamas markdown formatavimą.

10. **Vykdyti sugeneruotą kodą**:
    ```python
    import subprocess
    result = subprocess.run(["python", "-c", code], capture_output=True)
    ```
    Šis kodas vykdo išskirtą Python kodą kaip subprocesą ir užfiksuoja jo išvestį.

11. **Parodyti vaizdus**:
    ```python
    from IPython.display import Image, display
    display(Image(filename='./imgs/phi-3-vision.jpg'))
    display(Image(filename='./imgs/demo.png'))
    ```
    Šios eilutės parodo vaizdus naudojant `IPython.display` modulį.

---

**Atsakomybės apribojimas**:  
Šis dokumentas buvo išverstas naudojant dirbtinio intelekto vertimo paslaugą [Co-op Translator](https://github.com/Azure/co-op-translator). Nors siekiame tikslumo, atkreipiame dėmesį, kad automatiniai vertimai gali turėti klaidų ar netikslumų. Originalus dokumentas jo gimtąja kalba turėtų būti laikomas autoritetingu šaltiniu. Kritinei informacijai rekomenduojama naudotis profesionalių vertėjų paslaugomis. Mes neprisiimame atsakomybės už nesusipratimus ar klaidingus aiškinimus, kylančius dėl šio vertimo naudojimo.